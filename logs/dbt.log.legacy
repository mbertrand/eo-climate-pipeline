2023-03-31 01:57:54.960783 (MainThread): Running with dbt=1.4.5
2023-03-31 01:57:55.798175 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2023-03-31 01:57:55.806476 (MainThread): Tracking: tracking
2023-03-31 01:57:55.808181 (MainThread): 01:57:55  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7804452cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfae7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfaea160>]}
2023-03-31 01:57:55.808572 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=32
2023-03-31 01:57:55.809115 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2023-03-31 01:57:55.809821 (MainThread): Send requests to http://localhost:8580/jsonrpc
2023-03-31 01:57:55.901603 (Thread-12): 01:57:55  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 01:57:55.953027 (Thread-12): 01:57:55  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2023-03-31 01:57:55.953291 (Thread-12): 01:57:55  Partial parsing enabled, no changes found, skipping parsing
2023-03-31 01:57:55.954034 (Thread-12): 01:57:55  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 01:57:55.960599 (Thread-12): 01:57:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df97fa30>]}
2023-03-31 01:57:57.953037 (Thread-13): handling status request
2023-03-31 01:57:57.953565 (Thread-13): 01:57:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfa69100>]}
2023-03-31 01:57:57.954185 (Thread-13): sending response (<Response 2044 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.475428 (Thread-14): handling status request
2023-03-31 01:57:58.475933 (Thread-14): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df97ff70>]}
2023-03-31 01:57:58.476498 (Thread-14): sending response (<Response 2027 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.481206 (Thread-15): handling list request
2023-03-31 01:57:58.481534 (Thread-15): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df97fd90>]}
2023-03-31 01:57:58.498327 (Thread-15): 01:57:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df9858e0>]}
2023-03-31 01:57:58.498927 (Thread-15): 01:57:58  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 01:57:58.499307 (Thread-15): 01:57:58  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78044527f0>]}
2023-03-31 01:57:58.501123 (Thread-15): sending response (<Response 2338 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.510319 (Thread-16): handling ps request
2023-03-31 01:57:58.510637 (Thread-16): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df985370>]}
2023-03-31 01:57:58.511095 (Thread-16): sending response (<Response 390 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.638090 (Thread-17): handling ps request
2023-03-31 01:57:58.638575 (Thread-17): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df985610>]}
2023-03-31 01:57:58.639068 (Thread-17): sending response (<Response 390 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.830273 (Thread-18): handling status request
2023-03-31 01:57:58.830752 (Thread-18): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df98b400>]}
2023-03-31 01:57:58.831221 (Thread-18): sending response (<Response 2044 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:57:58.885114 (Thread-19): handling poll request
2023-03-31 01:57:58.885578 (Thread-19): 01:57:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df98b340>]}
2023-03-31 01:57:58.886129 (Thread-19): sending response (<Response 303 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:58:08.971413 (MainThread): 01:58:08  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7804452cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfb21c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfaea3d0>]}
2023-03-31 01:58:08.972788 (MainThread): 01:58:08  Flushing usage events
2023-03-31 01:58:09.000125 (MainThread): Runtime Error
  no dbt_project.yml found at expected path /usr/src/develop/user-169998/environment-166191/repository-138391/dbt_project.yml
2023-03-31 01:59:25.117508 (MainThread): Running with dbt=1.4.5
2023-03-31 01:59:25.141418 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2023-03-31 01:59:25.147141 (MainThread): Tracking: tracking
2023-03-31 01:59:25.147398 (MainThread): 01:59:25  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfae6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df874070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df98b280>]}
2023-03-31 01:59:25.147781 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=32
2023-03-31 01:59:25.152877 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2023-03-31 01:59:25.153059 (MainThread): Send requests to http://localhost:8580/jsonrpc
2023-03-31 01:59:25.153844 (Thread-20): 01:59:25  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 01:59:25.192960 (Thread-20): 01:59:25  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 01:59:25.193405 (Thread-20): 01:59:25  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 01:59:25.208423 (Thread-20): 01:59:25  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 01:59:25.223220 (Thread-20): 01:59:25  1602: parser fallback to jinja rendering on staging/stg_pusch_ridge_north.sql
2023-03-31 01:59:25.257452 (Thread-20): 01:59:25  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 01:59:25.263010 (Thread-20): 01:59:25  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df787eb0>]}
2023-03-31 01:59:25.264152 (Thread-21): handling status request
2023-03-31 01:59:25.264749 (Thread-21): 01:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df874310>]}
2023-03-31 01:59:25.265226 (Thread-21): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.093530 (Thread-22): handling ps request
2023-03-31 01:59:30.105851 (Thread-22): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776b80>]}
2023-03-31 01:59:30.106281 (Thread-22): sending response (<Response 100 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.178598 (Thread-23): handling status request
2023-03-31 01:59:30.179033 (Thread-23): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776730>]}
2023-03-31 01:59:30.179525 (Thread-23): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.268281 (Thread-24): handling status request
2023-03-31 01:59:30.269037 (Thread-25): handling ps request
2023-03-31 01:59:30.269502 (Thread-24): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776a60>]}
2023-03-31 01:59:30.269831 (Thread-25): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776220>]}
2023-03-31 01:59:30.270328 (Thread-24): sending response (<Response 2693 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.270739 (Thread-25): sending response (<Response 100 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.275574 (Thread-26): handling list request
2023-03-31 01:59:30.275874 (Thread-26): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7761f0>]}
2023-03-31 01:59:30.290188 (Thread-26): 01:59:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df88ad90>]}
2023-03-31 01:59:30.290666 (Thread-26): 01:59:30  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 01:59:30.290960 (Thread-26): 01:59:30  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df97f7f0>]}
2023-03-31 01:59:30.292492 (Thread-26): sending response (<Response 2338 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:30.888575 (Thread-27): handling status request
2023-03-31 01:59:30.889024 (Thread-27): 01:59:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776340>]}
2023-03-31 01:59:30.889519 (Thread-27): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:33.888550 (Thread-28): handling ps request
2023-03-31 01:59:33.889008 (Thread-28): 01:59:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df88a160>]}
2023-03-31 01:59:33.889502 (Thread-28): sending response (<Response 390 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:33.895641 (Thread-29): handling status request
2023-03-31 01:59:33.895980 (Thread-29): 01:59:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df785220>]}
2023-03-31 01:59:33.896399 (Thread-29): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:34.332263 (Thread-30): handling run_sql request
2023-03-31 01:59:34.332713 (Thread-30): 01:59:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df785340>]}
2023-03-31 01:59:34.353951 (Thread-31): handling ps request
2023-03-31 01:59:34.359071 (Thread-31): 01:59:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792820>]}
2023-03-31 01:59:34.360558 (Thread-31): sending response (<Response 953 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:34.630328 (Thread-32): handling poll request
2023-03-31 01:59:34.630770 (Thread-32): 01:59:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792a60>]}
2023-03-31 01:59:34.632013 (Thread-32): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:34.821648 (Thread-33): handling status request
2023-03-31 01:59:34.822088 (Thread-33): 01:59:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7deb50>]}
2023-03-31 01:59:34.822605 (Thread-33): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:36.840415 (Thread-34): handling poll request
2023-03-31 01:59:36.840854 (Thread-34): 01:59:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df88adf0>]}
2023-03-31 01:59:36.841340 (Thread-34): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:37.036666 (Thread-35): handling status request
2023-03-31 01:59:37.037129 (Thread-35): 01:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df98bf70>]}
2023-03-31 01:59:37.037624 (Thread-35): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:37.458017 (Thread-30): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:37.490689 (MainThread): 01:59:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f935d60-f755-4950-8562-4d2cdc765201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb6843be0>]}
2023-03-31 01:59:37.491276 (MainThread): 01:59:37  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 01:59:37.492704 (Thread-1): 01:59:37  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 01:59:37.492955 (Thread-1): 01:59:37  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 01:59:37.496431 (Thread-1): 01:59:37  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 01:59:37.493006 => 2023-03-31 01:59:37.496260
2023-03-31 01:59:37.496669 (Thread-1): 01:59:37  Began executing node rpc.dbt_eo_climate.request
2023-03-31 01:59:37.496982 (Thread-1): 01:59:37  Opening a new connection, currently in state init
2023-03-31 01:59:37.501732 (Thread-1): 01:59:37  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,
    row_number() over(partition by image_name) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where image_name is not null
)
select
    -- identifiers
    image_name,
    cast(SUBSTR(image_name, 18, 8)) as timestamp,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 01:59:37.729506 (Thread-1): 01:59:37  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [13:35]')
2023-03-31 01:59:37.738531 (Thread-36): handling ps request
2023-03-31 01:59:37.738946 (Thread-36): 01:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df785a00>]}
2023-03-31 01:59:37.739469 (Thread-36): sending response (<Response 948 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:37.746748 (Thread-37): handling ps request
2023-03-31 01:59:37.747061 (Thread-37): 01:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df787df0>]}
2023-03-31 01:59:37.747457 (Thread-37): sending response (<Response 948 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:37.932124 (Thread-1): 01:59:37  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:8aa18eb3-593f-40bc-a5b4-7beb43509f27&page=queryresults
2023-03-31 01:59:37.932417 (Thread-1): 01:59:37  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 01:59:37.496719 => 2023-03-31 01:59:37.932265
2023-03-31 01:59:37.932544 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected ")" at [13:35]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected ")" at [13:35]

Location: US
Job ID: 8aa18eb3-593f-40bc-a5b4-7beb43509f27


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Syntax error: Unexpected ")" at [13:35]
2023-03-31 01:59:37.934775 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected ")" at [13:35]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8)) as timestamp,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8)) as timestamp,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected ")" at [13:35]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8)) as timestamp,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8)) as timestamp,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 01:59:38.036213 (Thread-38): handling status request
2023-03-31 01:59:38.036716 (Thread-38): 01:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df98b280>]}
2023-03-31 01:59:38.037243 (Thread-38): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:38.081296 (Thread-39): handling poll request
2023-03-31 01:59:38.081743 (Thread-39): 01:59:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792220>]}
2023-03-31 01:59:38.082419 (Thread-39): sending response (<Response 13454 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:39.050289 (Thread-40): handling poll request
2023-03-31 01:59:39.050730 (Thread-40): 01:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792160>]}
2023-03-31 01:59:39.051323 (Thread-40): sending response (<Response 14875 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:39.486891 (Thread-41): handling status request
2023-03-31 01:59:39.487359 (Thread-41): 01:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792a00>]}
2023-03-31 01:59:39.487853 (Thread-41): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:39.559306 (Thread-42): handling poll request
2023-03-31 01:59:39.559739 (Thread-42): 01:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792970>]}
2023-03-31 01:59:39.560352 (Thread-42): sending response (<Response 14875 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:39.953558 (Thread-43): handling ps request
2023-03-31 01:59:39.954015 (Thread-43): 01:59:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792c70>]}
2023-03-31 01:59:39.954547 (Thread-43): sending response (<Response 971 bytes [200 OK]>) to 10.0.216.134
2023-03-31 01:59:40.362867 (Thread-44): handling status request
2023-03-31 01:59:40.363319 (Thread-44): 01:59:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792eb0>]}
2023-03-31 01:59:40.363807 (Thread-44): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:16.239542 (Thread-45): handling run_sql request
2023-03-31 02:00:16.241094 (Thread-45): 02:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792d90>]}
2023-03-31 02:00:16.243049 (Thread-46): handling ps request
2023-03-31 02:00:16.243672 (Thread-46): 02:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df817be0>]}
2023-03-31 02:00:16.282927 (Thread-46): sending response (<Response 1534 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:16.481246 (Thread-47): handling poll request
2023-03-31 02:00:16.481823 (Thread-47): 02:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df817f40>]}
2023-03-31 02:00:16.482380 (Thread-47): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:16.682009 (Thread-48): handling status request
2023-03-31 02:00:16.682463 (Thread-48): 02:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df817c40>]}
2023-03-31 02:00:16.683006 (Thread-48): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:16.752790 (Thread-49): handling ps request
2023-03-31 02:00:16.753228 (Thread-49): 02:00:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792520>]}
2023-03-31 02:00:16.753772 (Thread-49): sending response (<Response 1534 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:18.716699 (Thread-50): handling poll request
2023-03-31 02:00:18.717179 (Thread-50): 02:00:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7927f0>]}
2023-03-31 02:00:18.717677 (Thread-50): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:18.922523 (Thread-51): handling status request
2023-03-31 02:00:18.922956 (Thread-51): 02:00:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df787d30>]}
2023-03-31 02:00:18.923491 (Thread-51): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.339871 (Thread-45): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.372263 (MainThread): 02:00:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '925829d2-c5c9-4017-8680-4b646cec21e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c12b3b80>]}
2023-03-31 02:00:19.372858 (MainThread): 02:00:19  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:00:19.374244 (Thread-1): 02:00:19  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:00:19.374485 (Thread-1): 02:00:19  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:00:19.377896 (Thread-1): 02:00:19  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:00:19.374534 => 2023-03-31 02:00:19.377719
2023-03-31 02:00:19.378115 (Thread-1): 02:00:19  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:00:19.378287 (Thread-1): 02:00:19  Opening a new connection, currently in state init
2023-03-31 02:00:19.383153 (Thread-1): 02:00:19  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,
    row_number() over(partition by image_name) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where image_name is not null
)
select
    -- identifiers
    image_name,
    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:00:19.591411 (Thread-52): handling ps request
2023-03-31 02:00:19.591818 (Thread-52): 02:00:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776b50>]}
2023-03-31 02:00:19.592390 (Thread-52): sending response (<Response 1529 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.599387 (Thread-53): handling ps request
2023-03-31 02:00:19.599681 (Thread-53): 02:00:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776700>]}
2023-03-31 02:00:19.600122 (Thread-53): sending response (<Response 1529 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.856918 (Thread-54): handling status request
2023-03-31 02:00:19.857359 (Thread-54): 02:00:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df785220>]}
2023-03-31 02:00:19.857829 (Thread-54): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.916282 (Thread-55): handling poll request
2023-03-31 02:00:19.916848 (Thread-55): 02:00:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7850d0>]}
2023-03-31 02:00:19.917541 (Thread-55): sending response (<Response 3912 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:19.951112 (Thread-1): 02:00:19  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [8:9]')
2023-03-31 02:00:20.610271 (Thread-1): 02:00:20  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:e42bc30d-40da-46bd-a287-0fd890ccdef5&page=queryresults
2023-03-31 02:00:20.610579 (Thread-1): 02:00:20  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:00:19.378164 => 2023-03-31 02:00:20.610420
2023-03-31 02:00:20.610708 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [8:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [8:9]

Location: US
Job ID: e42bc30d-40da-46bd-a287-0fd890ccdef5


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [8:9]
2023-03-31 02:00:20.612943 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [8:9]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [8:9]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:00:20.923523 (Thread-56): handling poll request
2023-03-31 02:00:20.924007 (Thread-56): 02:00:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f220>]}
2023-03-31 02:00:20.924694 (Thread-56): sending response (<Response 13496 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:21.186294 (Thread-57): handling poll request
2023-03-31 02:00:21.186732 (Thread-57): 02:00:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f220>]}
2023-03-31 02:00:21.187314 (Thread-57): sending response (<Response 14938 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:21.195163 (Thread-58): handling status request
2023-03-31 02:00:21.195483 (Thread-58): 02:00:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f0a0>]}
2023-03-31 02:00:21.195883 (Thread-58): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:21.825414 (Thread-59): handling ps request
2023-03-31 02:00:21.825904 (Thread-59): 02:00:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f790>]}
2023-03-31 02:00:21.826507 (Thread-59): sending response (<Response 1552 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:22.032825 (Thread-60): handling status request
2023-03-31 02:00:22.033281 (Thread-60): 02:00:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f3d0>]}
2023-03-31 02:00:22.033761 (Thread-60): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:23.138481 (Thread-61): handling poll request
2023-03-31 02:00:23.138931 (Thread-61): 02:00:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80fc40>]}
2023-03-31 02:00:23.139577 (Thread-61): sending response (<Response 14938 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:23.732391 (Thread-62): handling status request
2023-03-31 02:00:23.732837 (Thread-62): 02:00:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80ff10>]}
2023-03-31 02:00:23.733334 (Thread-62): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:47.480599 (Thread-63): handling run_sql request
2023-03-31 02:00:47.481062 (Thread-63): 02:00:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7a1100>]}
2023-03-31 02:00:47.495846 (Thread-64): handling ps request
2023-03-31 02:00:47.500424 (Thread-64): 02:00:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7784c0>]}
2023-03-31 02:00:47.501970 (Thread-64): sending response (<Response 2115 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:47.861417 (Thread-65): handling poll request
2023-03-31 02:00:47.861866 (Thread-65): 02:00:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778f40>]}
2023-03-31 02:00:47.862379 (Thread-65): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:48.134773 (Thread-66): handling status request
2023-03-31 02:00:48.135219 (Thread-66): 02:00:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7781c0>]}
2023-03-31 02:00:48.135743 (Thread-66): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:48.195011 (Thread-67): handling ps request
2023-03-31 02:00:48.195433 (Thread-67): 02:00:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778760>]}
2023-03-31 02:00:48.196021 (Thread-67): sending response (<Response 2115 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:50.131091 (Thread-68): handling poll request
2023-03-31 02:00:50.131572 (Thread-68): 02:00:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7a1fa0>]}
2023-03-31 02:00:50.132071 (Thread-68): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:50.326898 (Thread-69): handling status request
2023-03-31 02:00:50.327341 (Thread-69): 02:00:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778160>]}
2023-03-31 02:00:50.327829 (Thread-69): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:50.597721 (Thread-63): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:50.630076 (MainThread): 02:00:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e940c0e8-d707-459d-9b49-69f76bd4fcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3c41cb50>]}
2023-03-31 02:00:50.630652 (MainThread): 02:00:50  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:00:50.632029 (Thread-1): 02:00:50  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:00:50.632268 (Thread-1): 02:00:50  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:00:50.635645 (Thread-1): 02:00:50  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:00:50.632315 => 2023-03-31 02:00:50.635480
2023-03-31 02:00:50.635894 (Thread-1): 02:00:50  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:00:50.636095 (Thread-1): 02:00:50  Opening a new connection, currently in state init
2023-03-31 02:00:50.641059 (Thread-1): 02:00:50  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,
    row_number() over(partition by image_name) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    image_name,
    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:00:50.894761 (Thread-70): handling ps request
2023-03-31 02:00:50.895191 (Thread-70): 02:00:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778c40>]}
2023-03-31 02:00:50.895776 (Thread-70): sending response (<Response 2110 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:50.901906 (Thread-71): handling ps request
2023-03-31 02:00:50.902194 (Thread-71): 02:00:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778e50>]}
2023-03-31 02:00:50.902638 (Thread-71): sending response (<Response 2110 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:51.074947 (Thread-1): 02:00:51  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [6:36]')
2023-03-31 02:00:51.135313 (Thread-72): handling status request
2023-03-31 02:00:51.135778 (Thread-72): 02:00:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7a11c0>]}
2023-03-31 02:00:51.136752 (Thread-72): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:51.184714 (Thread-73): handling poll request
2023-03-31 02:00:51.185036 (Thread-73): 02:00:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80fca0>]}
2023-03-31 02:00:51.185527 (Thread-73): sending response (<Response 4289 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:52.233393 (Thread-1): 02:00:52  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:2b938b5c-63d2-4195-8e84-1454a41eb403&page=queryresults
2023-03-31 02:00:52.233683 (Thread-1): 02:00:52  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:00:50.635945 => 2023-03-31 02:00:52.233535
2023-03-31 02:00:52.233810 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [6:36]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [6:36]

Location: US
Job ID: 2b938b5c-63d2-4195-8e84-1454a41eb403


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [6:36]
2023-03-31 02:00:52.235995 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [6:36]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [6:36]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as image_name,\n    row_number() over(partition by image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:00:52.378713 (Thread-74): handling poll request
2023-03-31 02:00:52.379149 (Thread-74): 02:00:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df785e50>]}
2023-03-31 02:00:52.379825 (Thread-74): sending response (<Response 13660 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:52.432744 (Thread-75): handling poll request
2023-03-31 02:00:52.433190 (Thread-75): 02:00:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776eb0>]}
2023-03-31 02:00:52.433752 (Thread-75): sending response (<Response 9836 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:52.583133 (Thread-76): handling status request
2023-03-31 02:00:52.583557 (Thread-76): 02:00:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df776eb0>]}
2023-03-31 02:00:52.607603 (Thread-76): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:53.094197 (Thread-77): handling ps request
2023-03-31 02:00:53.094719 (Thread-77): 02:00:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df787f70>]}
2023-03-31 02:00:53.095326 (Thread-77): sending response (<Response 2131 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:53.285386 (Thread-78): handling status request
2023-03-31 02:00:53.285819 (Thread-78): 02:00:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df792f40>]}
2023-03-31 02:00:53.286293 (Thread-78): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:53.674199 (Thread-79): handling poll request
2023-03-31 02:00:53.674641 (Thread-79): 02:00:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7927f0>]}
2023-03-31 02:00:53.675228 (Thread-79): sending response (<Response 15163 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:54.590110 (Thread-80): handling poll request
2023-03-31 02:00:54.590562 (Thread-80): 02:00:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df817b80>]}
2023-03-31 02:00:54.591157 (Thread-80): sending response (<Response 15163 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:00:55.115115 (Thread-81): handling status request
2023-03-31 02:00:55.115570 (Thread-81): 02:00:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778e50>]}
2023-03-31 02:00:55.116096 (Thread-81): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:15.074646 (Thread-82): handling run_sql request
2023-03-31 02:01:15.075109 (Thread-82): 02:01:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7789d0>]}
2023-03-31 02:01:15.094902 (Thread-83): handling ps request
2023-03-31 02:01:15.096551 (Thread-83): 02:01:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7779d0>]}
2023-03-31 02:01:15.098057 (Thread-83): sending response (<Response 2694 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:15.298413 (Thread-84): handling poll request
2023-03-31 02:01:15.298854 (Thread-84): 02:01:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777c40>]}
2023-03-31 02:01:15.299360 (Thread-84): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:15.504070 (Thread-85): handling status request
2023-03-31 02:01:15.504558 (Thread-85): 02:01:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777ca0>]}
2023-03-31 02:01:15.505101 (Thread-85): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:15.566651 (Thread-86): handling ps request
2023-03-31 02:01:15.567076 (Thread-86): 02:01:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777550>]}
2023-03-31 02:01:15.567673 (Thread-86): sending response (<Response 2694 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:17.529199 (Thread-87): handling poll request
2023-03-31 02:01:17.529645 (Thread-87): 02:01:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777fa0>]}
2023-03-31 02:01:17.530126 (Thread-87): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:17.735432 (Thread-88): handling status request
2023-03-31 02:01:17.735909 (Thread-88): 02:01:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777c70>]}
2023-03-31 02:01:17.736427 (Thread-88): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:18.180564 (Thread-82): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:18.212871 (MainThread): 02:01:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c73bc177-5861-4635-9aaf-686d66e81401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03db21bc10>]}
2023-03-31 02:01:18.213467 (MainThread): 02:01:18  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:01:18.214854 (Thread-1): 02:01:18  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:01:18.215100 (Thread-1): 02:01:18  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:01:18.218589 (Thread-1): 02:01:18  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:01:18.215150 => 2023-03-31 02:01:18.218420
2023-03-31 02:01:18.218804 (Thread-1): 02:01:18  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:01:18.219091 (Thread-1): 02:01:18  Opening a new connection, currently in state init
2023-03-31 02:01:18.223794 (Thread-1): 02:01:18  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    image_name,
    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:01:18.444707 (Thread-89): handling ps request
2023-03-31 02:01:18.445871 (Thread-90): handling ps request
2023-03-31 02:01:18.446199 (Thread-89): 02:01:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777e80>]}
2023-03-31 02:01:18.446580 (Thread-90): 02:01:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7537f0>]}
2023-03-31 02:01:18.447219 (Thread-89): sending response (<Response 2689 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:18.447828 (Thread-90): sending response (<Response 2689 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:18.715278 (Thread-1): 02:01:18  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [12:5]')
2023-03-31 02:01:18.784299 (Thread-91): handling status request
2023-03-31 02:01:18.784751 (Thread-91): 02:01:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7531c0>]}
2023-03-31 02:01:18.785257 (Thread-91): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:18.850040 (Thread-92): handling poll request
2023-03-31 02:01:18.850406 (Thread-92): 02:01:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753160>]}
2023-03-31 02:01:18.850953 (Thread-92): sending response (<Response 4263 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:19.739373 (Thread-93): handling poll request
2023-03-31 02:01:19.739820 (Thread-93): 02:01:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753430>]}
2023-03-31 02:01:19.740413 (Thread-93): sending response (<Response 4263 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:19.911064 (Thread-1): 02:01:19  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:67ae5ea4-1e0e-49fa-acbb-f23606059d2a&page=queryresults
2023-03-31 02:01:19.911370 (Thread-1): 02:01:19  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:01:18.218851 => 2023-03-31 02:01:19.911216
2023-03-31 02:01:19.911501 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [12:5]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [12:5]

Location: US
Job ID: 67ae5ea4-1e0e-49fa-acbb-f23606059d2a


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [12:5]
2023-03-31 02:01:19.913717 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [12:5]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [12:5]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:01:19.939653 (Thread-94): handling status request
2023-03-31 02:01:19.940111 (Thread-94): 02:01:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7536a0>]}
2023-03-31 02:01:19.940605 (Thread-94): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:20.070791 (Thread-95): handling poll request
2023-03-31 02:01:20.071241 (Thread-95): 02:01:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7539d0>]}
2023-03-31 02:01:20.072389 (Thread-95): sending response (<Response 9732 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:20.801505 (Thread-96): handling ps request
2023-03-31 02:01:20.801958 (Thread-96): 02:01:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777d60>]}
2023-03-31 02:01:20.802571 (Thread-96): sending response (<Response 2712 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:20.994907 (Thread-97): handling status request
2023-03-31 02:01:20.995400 (Thread-97): 02:01:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777b50>]}
2023-03-31 02:01:20.995896 (Thread-97): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:21.268521 (Thread-98): handling poll request
2023-03-31 02:01:21.268967 (Thread-98): 02:01:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777a60>]}
2023-03-31 02:01:21.269600 (Thread-98): sending response (<Response 14981 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:21.947925 (Thread-99): handling poll request
2023-03-31 02:01:21.948445 (Thread-99): 02:01:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df8179a0>]}
2023-03-31 02:01:21.949045 (Thread-99): sending response (<Response 14981 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:22.477517 (Thread-100): handling status request
2023-03-31 02:01:22.477994 (Thread-100): 02:01:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df80f3a0>]}
2023-03-31 02:01:22.478486 (Thread-100): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:41.534675 (Thread-101): handling run_sql request
2023-03-31 02:01:41.535189 (Thread-101): 02:01:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7a1070>]}
2023-03-31 02:01:41.555018 (Thread-102): handling ps request
2023-03-31 02:01:41.556662 (Thread-102): 02:01:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753d00>]}
2023-03-31 02:01:41.558312 (Thread-102): sending response (<Response 3275 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:41.758709 (Thread-103): handling poll request
2023-03-31 02:01:41.759148 (Thread-103): 02:01:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753f70>]}
2023-03-31 02:01:41.759651 (Thread-103): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:41.974383 (Thread-104): handling status request
2023-03-31 02:01:41.974829 (Thread-104): 02:01:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753e50>]}
2023-03-31 02:01:41.975358 (Thread-104): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:42.048394 (Thread-105): handling ps request
2023-03-31 02:01:42.048830 (Thread-105): 02:01:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759160>]}
2023-03-31 02:01:42.049464 (Thread-105): sending response (<Response 3275 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:43.982572 (Thread-106): handling poll request
2023-03-31 02:01:43.983018 (Thread-106): 02:01:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759310>]}
2023-03-31 02:01:44.012402 (Thread-106): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:44.218374 (Thread-107): handling status request
2023-03-31 02:01:44.218854 (Thread-107): 02:01:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753370>]}
2023-03-31 02:01:44.219332 (Thread-107): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:44.643665 (Thread-101): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:44.675994 (MainThread): 02:01:44  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '627c04c1-f405-407f-928d-81bf50cf47d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ec2a6b50>]}
2023-03-31 02:01:44.676584 (MainThread): 02:01:44  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:01:44.677917 (Thread-1): 02:01:44  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:01:44.678156 (Thread-1): 02:01:44  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:01:44.681578 (Thread-1): 02:01:44  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:01:44.678206 => 2023-03-31 02:01:44.681413
2023-03-31 02:01:44.681791 (Thread-1): 02:01:44  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:01:44.681955 (Thread-1): 02:01:44  Opening a new connection, currently in state init
2023-03-31 02:01:44.686906 (Thread-1): 02:01:44  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as string) as image_name,
    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:01:44.834358 (Thread-108): handling ps request
2023-03-31 02:01:44.834810 (Thread-108): 02:01:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759c10>]}
2023-03-31 02:01:44.835467 (Thread-108): sending response (<Response 3270 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:44.841825 (Thread-109): handling ps request
2023-03-31 02:01:44.842138 (Thread-109): 02:01:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7598e0>]}
2023-03-31 02:01:44.842640 (Thread-109): sending response (<Response 3270 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:45.068732 (Thread-110): handling status request
2023-03-31 02:01:45.069185 (Thread-110): 02:01:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759ca0>]}
2023-03-31 02:01:45.069671 (Thread-110): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:45.078204 (Thread-1): 02:01:45  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [13:17]')
2023-03-31 02:01:45.124336 (Thread-111): handling poll request
2023-03-31 02:01:45.124661 (Thread-111): 02:01:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759250>]}
2023-03-31 02:01:45.125179 (Thread-111): sending response (<Response 4324 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:45.676099 (Thread-1): 02:01:45  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:20191d1a-b026-42db-8432-31c437964b17&page=queryresults
2023-03-31 02:01:45.676393 (Thread-1): 02:01:45  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:01:44.681837 => 2023-03-31 02:01:45.676241
2023-03-31 02:01:45.676525 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [13:17]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [13:17]

Location: US
Job ID: 20191d1a-b026-42db-8432-31c437964b17


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [13:17]
2023-03-31 02:01:45.678700 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [13:17]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as string) as image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as string) as image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [13:17]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) as string) as image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) as string) as image_name,\n    cast(SUBSTR(image_name, 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:01:46.206618 (Thread-112): handling poll request
2023-03-31 02:01:46.207097 (Thread-112): 02:01:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7534f0>]}
2023-03-31 02:01:46.207685 (Thread-112): sending response (<Response 15416 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:46.323011 (Thread-113): handling poll request
2023-03-31 02:01:46.323381 (Thread-113): 02:01:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759a60>]}
2023-03-31 02:01:46.323925 (Thread-113): sending response (<Response 15416 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:46.808744 (Thread-114): handling status request
2023-03-31 02:01:46.809198 (Thread-114): 02:01:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7543a0>]}
2023-03-31 02:01:46.809677 (Thread-114): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:47.082186 (Thread-115): handling ps request
2023-03-31 02:01:47.082642 (Thread-115): 02:01:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754250>]}
2023-03-31 02:01:47.083262 (Thread-115): sending response (<Response 3293 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:01:47.272893 (Thread-116): handling status request
2023-03-31 02:01:47.273362 (Thread-116): 02:01:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754970>]}
2023-03-31 02:01:47.273848 (Thread-116): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:37.254419 (Thread-117): handling run_sql request
2023-03-31 02:02:37.256237 (Thread-117): 02:02:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df759760>]}
2023-03-31 02:02:37.271171 (Thread-118): handling ps request
2023-03-31 02:02:37.275365 (Thread-118): 02:02:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df777eb0>]}
2023-03-31 02:02:37.277158 (Thread-118): sending response (<Response 3856 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:37.488144 (Thread-119): handling poll request
2023-03-31 02:02:37.488591 (Thread-119): 02:02:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754850>]}
2023-03-31 02:02:37.489123 (Thread-119): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:37.678583 (Thread-120): handling status request
2023-03-31 02:02:37.679026 (Thread-120): 02:02:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7545e0>]}
2023-03-31 02:02:37.679555 (Thread-120): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:37.751698 (Thread-121): handling ps request
2023-03-31 02:02:37.752177 (Thread-121): 02:02:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7544f0>]}
2023-03-31 02:02:37.752846 (Thread-121): sending response (<Response 3855 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:39.729206 (Thread-122): handling poll request
2023-03-31 02:02:39.729673 (Thread-122): 02:02:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754190>]}
2023-03-31 02:02:39.730190 (Thread-122): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:39.929348 (Thread-123): handling status request
2023-03-31 02:02:39.929787 (Thread-123): 02:02:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754280>]}
2023-03-31 02:02:39.930289 (Thread-123): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:40.395322 (Thread-117): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:40.428982 (MainThread): 02:02:40  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd29c8a3-db70-46d8-88b2-b3a40e043bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc5127ec40>]}
2023-03-31 02:02:40.429586 (MainThread): 02:02:40  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:02:40.431073 (Thread-1): 02:02:40  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:02:40.431311 (Thread-1): 02:02:40  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:02:40.435030 (Thread-1): 02:02:40  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:02:40.431359 => 2023-03-31 02:02:40.434863
2023-03-31 02:02:40.435484 (Thread-1): 02:02:40  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:02:40.435766 (Thread-1): 02:02:40  Opening a new connection, currently in state init
2023-03-31 02:02:40.441493 (Thread-1): 02:02:40  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:02:40.650207 (Thread-124): handling ps request
2023-03-31 02:02:40.650663 (Thread-124): 02:02:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754160>]}
2023-03-31 02:02:40.651351 (Thread-124): sending response (<Response 3851 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:40.658506 (Thread-125): handling ps request
2023-03-31 02:02:40.658820 (Thread-125): 02:02:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754d00>]}
2023-03-31 02:02:40.659354 (Thread-125): sending response (<Response 3851 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:40.987550 (Thread-126): handling status request
2023-03-31 02:02:40.988032 (Thread-126): 02:02:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754b50>]}
2023-03-31 02:02:40.988534 (Thread-126): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:41.045916 (Thread-127): handling poll request
2023-03-31 02:02:41.046370 (Thread-127): 02:02:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754100>]}
2023-03-31 02:02:41.046945 (Thread-127): sending response (<Response 3982 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:41.094454 (Thread-1): 02:02:41  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '20180422'")
2023-03-31 02:02:41.697493 (Thread-1): 02:02:41  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:8e7962fc-199c-4cf9-b867-240e7c3131fc&page=queryresults
2023-03-31 02:02:41.697782 (Thread-1): 02:02:41  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:02:40.435569 => 2023-03-31 02:02:41.697631
2023-03-31 02:02:41.697912 (Thread-1): Got an exception: Database Error
  Invalid timestamp: '20210719'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Invalid timestamp: '20210719'

Location: US
Job ID: 8e7962fc-199c-4cf9-b867-240e7c3131fc


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Invalid timestamp: '20210719'
2023-03-31 02:02:41.700077 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid timestamp: '20210719'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid timestamp: '20210719'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:02:41.919356 (Thread-128): handling poll request
2023-03-31 02:02:41.919787 (Thread-128): 02:02:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df735100>]}
2023-03-31 02:02:41.920453 (Thread-128): sending response (<Response 13822 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:42.112681 (Thread-129): handling status request
2023-03-31 02:02:42.113129 (Thread-129): 02:02:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df735100>]}
2023-03-31 02:02:42.113608 (Thread-129): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:42.273758 (Thread-130): handling poll request
2023-03-31 02:02:42.274199 (Thread-130): 02:02:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7351c0>]}
2023-03-31 02:02:42.274828 (Thread-130): sending response (<Response 15395 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:42.955042 (Thread-131): handling ps request
2023-03-31 02:02:42.955490 (Thread-131): 02:02:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df735640>]}
2023-03-31 02:02:42.956159 (Thread-131): sending response (<Response 3874 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:43.148388 (Thread-132): handling status request
2023-03-31 02:02:43.148868 (Thread-132): 02:02:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7542b0>]}
2023-03-31 02:02:43.149372 (Thread-132): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:44.128361 (Thread-133): handling poll request
2023-03-31 02:02:44.128851 (Thread-133): 02:02:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754fa0>]}
2023-03-31 02:02:44.129463 (Thread-133): sending response (<Response 15395 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:44.655217 (Thread-134): handling status request
2023-03-31 02:02:44.655663 (Thread-134): 02:02:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df735c40>]}
2023-03-31 02:02:44.656175 (Thread-134): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:56.897824 (Thread-135): handling run_sql request
2023-03-31 02:02:56.898294 (Thread-135): 02:02:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df735d30>]}
2023-03-31 02:02:56.920129 (Thread-136): handling ps request
2023-03-31 02:02:56.921657 (Thread-136): 02:02:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8d30>]}
2023-03-31 02:02:56.947128 (Thread-136): sending response (<Response 4437 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:57.134199 (Thread-137): handling poll request
2023-03-31 02:02:57.134651 (Thread-137): 02:02:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e81f0>]}
2023-03-31 02:02:57.135174 (Thread-137): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:57.327793 (Thread-138): handling status request
2023-03-31 02:02:57.328256 (Thread-138): 02:02:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8e20>]}
2023-03-31 02:02:57.328783 (Thread-138): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:57.407951 (Thread-139): handling ps request
2023-03-31 02:02:57.408431 (Thread-139): 02:02:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8280>]}
2023-03-31 02:02:57.409117 (Thread-139): sending response (<Response 4437 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:59.379316 (Thread-140): handling poll request
2023-03-31 02:02:59.379812 (Thread-140): 02:02:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7357c0>]}
2023-03-31 02:02:59.380334 (Thread-140): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:02:59.580743 (Thread-141): handling status request
2023-03-31 02:02:59.581198 (Thread-141): 02:02:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7351f0>]}
2023-03-31 02:02:59.581683 (Thread-141): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.066622 (Thread-135): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.099187 (MainThread): 02:03:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b7a6c6e-dbcc-4b10-8a24-dfb3b51c89bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb19ba87c10>]}
2023-03-31 02:03:00.099799 (MainThread): 02:03:00  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:03:00.101182 (Thread-1): 02:03:00  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:03:00.101418 (Thread-1): 02:03:00  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:03:00.104895 (Thread-1): 02:03:00  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:03:00.101465 => 2023-03-31 02:03:00.104733
2023-03-31 02:03:00.105121 (Thread-1): 02:03:00  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:03:00.105398 (Thread-1): 02:03:00  Opening a new connection, currently in state init
2023-03-31 02:03:00.110228 (Thread-1): 02:03:00  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as date,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:03:00.265995 (Thread-142): handling ps request
2023-03-31 02:03:00.266444 (Thread-142): 02:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754a90>]}
2023-03-31 02:03:00.267144 (Thread-142): sending response (<Response 4432 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.273293 (Thread-143): handling ps request
2023-03-31 02:03:00.273600 (Thread-143): 02:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754c70>]}
2023-03-31 02:03:00.274139 (Thread-143): sending response (<Response 4431 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.460354 (Thread-144): handling status request
2023-03-31 02:03:00.460834 (Thread-144): 02:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7541c0>]}
2023-03-31 02:03:00.461355 (Thread-144): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.532418 (Thread-145): handling poll request
2023-03-31 02:03:00.532873 (Thread-145): 02:03:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754e50>]}
2023-03-31 02:03:00.533463 (Thread-145): sending response (<Response 3978 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:00.767745 (Thread-1): 02:03:00  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid timestamp: '20180422'")
2023-03-31 02:03:01.425894 (Thread-1): 02:03:01  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:f83546c3-4d4a-4cc2-8837-9ff3b00826ab&page=queryresults
2023-03-31 02:03:01.426188 (Thread-1): 02:03:01  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:03:00.105167 => 2023-03-31 02:03:01.426040
2023-03-31 02:03:01.426320 (Thread-1): Got an exception: Database Error
  Invalid timestamp: '20180321'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Invalid timestamp: '20180321'

Location: US
Job ID: f83546c3-4d4a-4cc2-8837-9ff3b00826ab


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Invalid timestamp: '20180321'
2023-03-31 02:03:01.428502 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid timestamp: '20180321'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as timestamp) as date,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as date,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid timestamp: '20180321'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as timestamp) as date,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as timestamp) as date,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:03:01.592570 (Thread-146): handling poll request
2023-03-31 02:03:01.593035 (Thread-146): 02:03:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f100>]}
2023-03-31 02:03:01.593712 (Thread-146): sending response (<Response 13802 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:01.742204 (Thread-147): handling poll request
2023-03-31 02:03:01.742661 (Thread-147): 02:03:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f1f0>]}
2023-03-31 02:03:01.743239 (Thread-147): sending response (<Response 10289 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:01.846595 (Thread-148): handling status request
2023-03-31 02:03:01.847067 (Thread-148): 02:03:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7357c0>]}
2023-03-31 02:03:01.847535 (Thread-148): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:02.470450 (Thread-149): handling ps request
2023-03-31 02:03:02.470890 (Thread-149): 02:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f430>]}
2023-03-31 02:03:02.471535 (Thread-149): sending response (<Response 4454 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:02.664898 (Thread-150): handling status request
2023-03-31 02:03:02.665339 (Thread-150): 02:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f580>]}
2023-03-31 02:03:02.665803 (Thread-150): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:02.945737 (Thread-151): handling poll request
2023-03-31 02:03:02.946177 (Thread-151): 02:03:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f610>]}
2023-03-31 02:03:02.946744 (Thread-151): sending response (<Response 15367 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:03.813542 (Thread-152): handling poll request
2023-03-31 02:03:03.813987 (Thread-152): 02:03:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f940>]}
2023-03-31 02:03:03.814556 (Thread-152): sending response (<Response 15367 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:04.344537 (Thread-153): handling status request
2023-03-31 02:03:04.345000 (Thread-153): 02:03:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74fd00>]}
2023-03-31 02:03:04.345484 (Thread-153): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:18.589152 (Thread-154): handling run_sql request
2023-03-31 02:03:18.589600 (Thread-154): 02:03:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74fdf0>]}
2023-03-31 02:03:18.607554 (Thread-155): handling ps request
2023-03-31 02:03:18.609260 (Thread-155): 02:03:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9df0>]}
2023-03-31 02:03:18.611053 (Thread-155): sending response (<Response 5017 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:18.831030 (Thread-156): handling poll request
2023-03-31 02:03:18.831467 (Thread-156): 02:03:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9f10>]}
2023-03-31 02:03:18.832004 (Thread-156): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:19.034845 (Thread-157): handling status request
2023-03-31 02:03:19.035291 (Thread-157): 02:03:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704070>]}
2023-03-31 02:03:19.035819 (Thread-157): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:19.089011 (Thread-158): handling ps request
2023-03-31 02:03:19.089398 (Thread-158): 02:03:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704160>]}
2023-03-31 02:03:19.090074 (Thread-158): sending response (<Response 5017 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:21.049495 (Thread-159): handling poll request
2023-03-31 02:03:21.049975 (Thread-159): 02:03:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9d90>]}
2023-03-31 02:03:21.050434 (Thread-159): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:21.245063 (Thread-160): handling status request
2023-03-31 02:03:21.245493 (Thread-160): 02:03:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704430>]}
2023-03-31 02:03:21.245959 (Thread-160): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:21.690264 (Thread-154): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:21.722591 (MainThread): 02:03:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8638617-fd6c-4870-a617-8a97152d6ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1434ff6c10>]}
2023-03-31 02:03:21.723178 (MainThread): 02:03:21  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:03:21.724554 (Thread-1): 02:03:21  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:03:21.724790 (Thread-1): 02:03:21  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:03:21.728216 (Thread-1): 02:03:21  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:03:21.724839 => 2023-03-31 02:03:21.728045
2023-03-31 02:03:21.728432 (Thread-1): 02:03:21  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:03:21.728598 (Thread-1): 02:03:21  Opening a new connection, currently in state init
2023-03-31 02:03:21.733556 (Thread-1): 02:03:21  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:03:21.996384 (Thread-161): handling ps request
2023-03-31 02:03:21.996838 (Thread-161): 02:03:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704520>]}
2023-03-31 02:03:21.998116 (Thread-161): sending response (<Response 5012 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:22.004198 (Thread-162): handling ps request
2023-03-31 02:03:22.004503 (Thread-162): 02:03:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74fd90>]}
2023-03-31 02:03:22.005053 (Thread-162): sending response (<Response 5012 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:22.282045 (Thread-163): handling status request
2023-03-31 02:03:22.282480 (Thread-163): 02:03:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f250>]}
2023-03-31 02:03:22.282958 (Thread-163): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:22.324094 (Thread-1): 02:03:22  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Invalid date: '20190714'")
2023-03-31 02:03:22.336841 (Thread-164): handling poll request
2023-03-31 02:03:22.337200 (Thread-164): 02:03:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f790>]}
2023-03-31 02:03:22.337741 (Thread-164): sending response (<Response 4311 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:23.193725 (Thread-1): 02:03:23  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:d1b927be-51cd-48db-900a-10787d88bc9f&page=queryresults
2023-03-31 02:03:23.194018 (Thread-1): 02:03:23  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:03:21.728480 => 2023-03-31 02:03:23.193873
2023-03-31 02:03:23.194147 (Thread-1): Got an exception: Database Error
  Invalid date: '20220831'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Invalid date: '20220831'

Location: US
Job ID: d1b927be-51cd-48db-900a-10787d88bc9f


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Invalid date: '20220831'
2023-03-31 02:03:23.196369 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid date: '20220831'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': "Database Error in rpc request (from remote system.sql)\n  Invalid date: '20220831'", 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18, 8) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18, 8) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:03:23.246973 (Thread-165): handling poll request
2023-03-31 02:03:23.247414 (Thread-165): 02:03:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7355b0>]}
2023-03-31 02:03:23.248106 (Thread-165): sending response (<Response 13767 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:23.560911 (Thread-166): handling poll request
2023-03-31 02:03:23.561386 (Thread-166): 02:03:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7355e0>]}
2023-03-31 02:03:23.586829 (Thread-166): sending response (<Response 15325 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:23.614752 (Thread-167): handling status request
2023-03-31 02:03:23.615139 (Thread-167): 02:03:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8d00>]}
2023-03-31 02:03:23.615584 (Thread-167): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:24.250923 (Thread-168): handling ps request
2023-03-31 02:03:24.251374 (Thread-168): 02:03:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8c70>]}
2023-03-31 02:03:24.252105 (Thread-168): sending response (<Response 5034 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:24.444222 (Thread-169): handling status request
2023-03-31 02:03:24.444713 (Thread-169): 02:03:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df74f280>]}
2023-03-31 02:03:24.445216 (Thread-169): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:25.450854 (Thread-170): handling poll request
2023-03-31 02:03:25.451299 (Thread-170): 02:03:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6e8670>]}
2023-03-31 02:03:25.451890 (Thread-170): sending response (<Response 15325 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:03:26.009777 (Thread-171): handling status request
2023-03-31 02:03:26.010246 (Thread-171): 02:03:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754c40>]}
2023-03-31 02:03:26.010742 (Thread-171): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:05:43.900560 (Thread-172): handling status request
2023-03-31 02:05:43.902272 (Thread-172): 02:05:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df754100>]}
2023-03-31 02:05:43.902773 (Thread-172): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:38.265993 (Thread-173): handling run_sql request
2023-03-31 02:06:38.266454 (Thread-173): 02:06:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704340>]}
2023-03-31 02:06:38.285858 (Thread-174): handling ps request
2023-03-31 02:06:38.287496 (Thread-174): 02:06:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7082e0>]}
2023-03-31 02:06:38.289324 (Thread-174): sending response (<Response 5597 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:38.483075 (Thread-175): handling poll request
2023-03-31 02:06:38.483555 (Thread-175): 02:06:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704f70>]}
2023-03-31 02:06:38.484127 (Thread-175): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:38.671488 (Thread-176): handling status request
2023-03-31 02:06:38.671934 (Thread-176): 02:06:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708580>]}
2023-03-31 02:06:38.672474 (Thread-176): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:38.732622 (Thread-177): handling ps request
2023-03-31 02:06:38.733060 (Thread-177): 02:06:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708610>]}
2023-03-31 02:06:38.733776 (Thread-177): sending response (<Response 5597 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:40.702807 (Thread-178): handling poll request
2023-03-31 02:06:40.703255 (Thread-178): 02:06:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7088b0>]}
2023-03-31 02:06:40.703723 (Thread-178): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:40.893065 (Thread-179): handling status request
2023-03-31 02:06:40.893504 (Thread-179): 02:06:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708850>]}
2023-03-31 02:06:40.893971 (Thread-179): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:41.340281 (Thread-173): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:41.375774 (MainThread): 02:06:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab49289-9a37-4f1b-a778-3802129d3898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0291f20bb0>]}
2023-03-31 02:06:41.376380 (MainThread): 02:06:41  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:06:41.377746 (Thread-1): 02:06:41  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:06:41.377986 (Thread-1): 02:06:41  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:06:41.381429 (Thread-1): 02:06:41  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:06:41.378036 => 2023-03-31 02:06:41.381266
2023-03-31 02:06:41.381644 (Thread-1): 02:06:41  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:06:41.381813 (Thread-1): 02:06:41  Opening a new connection, currently in state init
2023-03-31 02:06:41.386609 (Thread-1): 02:06:41  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:06:41.530803 (Thread-180): handling ps request
2023-03-31 02:06:41.531233 (Thread-180): 02:06:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7089d0>]}
2023-03-31 02:06:41.532026 (Thread-180): sending response (<Response 5592 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:41.537540 (Thread-181): handling ps request
2023-03-31 02:06:41.537828 (Thread-181): 02:06:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708ac0>]}
2023-03-31 02:06:41.538416 (Thread-181): sending response (<Response 5591 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:41.758885 (Thread-182): handling status request
2023-03-31 02:06:41.759321 (Thread-182): 02:06:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708a00>]}
2023-03-31 02:06:41.759795 (Thread-182): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:41.822084 (Thread-183): handling poll request
2023-03-31 02:06:41.822425 (Thread-183): 02:06:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708c70>]}
2023-03-31 02:06:41.822933 (Thread-183): sending response (<Response 4008 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:42.705746 (Thread-1): 02:06:42  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:eab2f66e-e9fe-45c5-bb6d-039dff6b3758&page=queryresults
2023-03-31 02:06:42.706255 (Thread-1): 02:06:42  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:06:41.381691 => 2023-03-31 02:06:42.706083
2023-03-31 02:06:42.907084 (Thread-184): handling poll request
2023-03-31 02:06:42.907573 (Thread-184): 02:06:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9df0>]}
2023-03-31 02:06:42.908195 (Thread-184): sending response (<Response 4868 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:43.033619 (Thread-185): handling poll request
2023-03-31 02:06:43.034062 (Thread-185): 02:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708ee0>]}
2023-03-31 02:06:43.036359 (Thread-185): sending response (<Response 25323 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:43.150609 (Thread-186): handling status request
2023-03-31 02:06:43.151062 (Thread-186): 02:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704d90>]}
2023-03-31 02:06:43.151530 (Thread-186): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:43.735688 (Thread-187): handling ps request
2023-03-31 02:06:43.736150 (Thread-187): 02:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6b90a0>]}
2023-03-31 02:06:43.736853 (Thread-187): sending response (<Response 5617 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:43.928692 (Thread-188): handling status request
2023-03-31 02:06:43.929133 (Thread-188): 02:06:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c0970>]}
2023-03-31 02:06:43.929601 (Thread-188): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:45.100754 (Thread-189): handling poll request
2023-03-31 02:06:45.101261 (Thread-189): 02:06:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704ac0>]}
2023-03-31 02:06:45.103310 (Thread-189): sending response (<Response 28866 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:45.664702 (Thread-190): handling status request
2023-03-31 02:06:45.665199 (Thread-190): 02:06:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6b9610>]}
2023-03-31 02:06:45.665678 (Thread-190): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:06:45.694881 (Thread-191): handling ps request
2023-03-31 02:06:45.695238 (Thread-191): 02:06:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c2130>]}
2023-03-31 02:06:45.695898 (Thread-191): sending response (<Response 5617 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:23.378224 (Thread-192): handling run_sql request
2023-03-31 02:07:23.378677 (Thread-192): 02:07:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c60a0>]}
2023-03-31 02:07:23.396855 (Thread-193): handling ps request
2023-03-31 02:07:23.398589 (Thread-193): 02:07:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7160>]}
2023-03-31 02:07:23.401000 (Thread-193): sending response (<Response 6180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:23.591884 (Thread-194): handling poll request
2023-03-31 02:07:23.592420 (Thread-194): 02:07:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c6c70>]}
2023-03-31 02:07:23.592940 (Thread-194): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:23.791511 (Thread-195): handling status request
2023-03-31 02:07:23.791946 (Thread-195): 02:07:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c0670>]}
2023-03-31 02:07:23.792492 (Thread-195): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:23.849260 (Thread-196): handling ps request
2023-03-31 02:07:23.849712 (Thread-196): 02:07:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c07f0>]}
2023-03-31 02:07:23.878973 (Thread-196): sending response (<Response 6180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:25.823078 (Thread-197): handling poll request
2023-03-31 02:07:25.823529 (Thread-197): 02:07:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708970>]}
2023-03-31 02:07:25.824034 (Thread-197): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:26.018792 (Thread-198): handling status request
2023-03-31 02:07:26.019254 (Thread-198): 02:07:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708280>]}
2023-03-31 02:07:26.019743 (Thread-198): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:26.494008 (Thread-192): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:26.526403 (MainThread): 02:07:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b608a6-4443-4fc7-a47b-2258ab78b06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc6727bb0>]}
2023-03-31 02:07:26.526997 (MainThread): 02:07:26  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:07:26.528383 (Thread-1): 02:07:26  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:07:26.528623 (Thread-1): 02:07:26  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:07:26.532069 (Thread-1): 02:07:26  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:07:26.528671 => 2023-03-31 02:07:26.531880
2023-03-31 02:07:26.532288 (Thread-1): 02:07:26  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:07:26.532454 (Thread-1): 02:07:26  Opening a new connection, currently in state init
2023-03-31 02:07:26.537307 (Thread-1): 02:07:26  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north order by year, month
where rn = 1
-- dbt build --m <model.sql> --var 'is_test_run: false'

2023-03-31 02:07:26.778295 (Thread-1): 02:07:26  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword WHERE at [21:1]')
2023-03-31 02:07:26.786507 (Thread-199): handling ps request
2023-03-31 02:07:26.786914 (Thread-199): 02:07:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708970>]}
2023-03-31 02:07:26.787653 (Thread-199): sending response (<Response 6175 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:26.935375 (Thread-200): handling ps request
2023-03-31 02:07:26.935802 (Thread-200): 02:07:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708880>]}
2023-03-31 02:07:26.936557 (Thread-200): sending response (<Response 6175 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:27.011884 (Thread-201): handling status request
2023-03-31 02:07:27.012329 (Thread-201): 02:07:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7eb0>]}
2023-03-31 02:07:27.012806 (Thread-201): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:27.075102 (Thread-202): handling poll request
2023-03-31 02:07:27.075482 (Thread-202): 02:07:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7460>]}
2023-03-31 02:07:27.076047 (Thread-202): sending response (<Response 4404 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:27.505482 (Thread-1): 02:07:27  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:594dcd44-910d-4e71-a48c-59ec01516ed2&page=queryresults
2023-03-31 02:07:27.505778 (Thread-1): 02:07:27  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:07:26.532335 => 2023-03-31 02:07:27.505626
2023-03-31 02:07:27.505904 (Thread-1): Got an exception: Database Error
  Syntax error: Expected end of input but got keyword WHERE at [21:1]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected end of input but got keyword WHERE at [21:1]

Location: US
Job ID: 594dcd44-910d-4e71-a48c-59ec01516ed2


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Syntax error: Expected end of input but got keyword WHERE at [21:1]
2023-03-31 02:07:27.508108 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected end of input but got keyword WHERE at [21:1]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north order by year, month\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north order by year, month\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected end of input but got keyword WHERE at [21:1]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north order by year, month\nwhere rn = 1\n-- dbt build --m <model.sql> --var \'is_test_run: false\'\n{% if var(\'is_test_run\', default=false) %}\n  limit 100\n{% endif %}', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north order by year, month\nwhere rn = 1\n-- dbt build --m <model.sql> --var 'is_test_run: false'\n", 'tags': None}, None)
2023-03-31 02:07:28.060304 (Thread-203): handling poll request
2023-03-31 02:07:28.060744 (Thread-203): 02:07:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7dc0>]}
2023-03-31 02:07:28.061346 (Thread-203): sending response (<Response 16000 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:28.637135 (Thread-204): handling status request
2023-03-31 02:07:28.637580 (Thread-204): 02:07:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a77f0>]}
2023-03-31 02:07:28.638066 (Thread-204): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:28.747825 (Thread-205): handling poll request
2023-03-31 02:07:28.748192 (Thread-205): 02:07:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7c70>]}
2023-03-31 02:07:28.748720 (Thread-205): sending response (<Response 16000 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:29.072099 (Thread-206): handling ps request
2023-03-31 02:07:29.072541 (Thread-206): 02:07:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c9190>]}
2023-03-31 02:07:29.073296 (Thread-206): sending response (<Response 6198 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:29.277165 (Thread-207): handling status request
2023-03-31 02:07:29.277609 (Thread-207): 02:07:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c93d0>]}
2023-03-31 02:07:29.278087 (Thread-207): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:47.267563 (Thread-208): handling run_sql request
2023-03-31 02:07:47.268101 (Thread-208): 02:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c0670>]}
2023-03-31 02:07:47.301495 (Thread-209): handling ps request
2023-03-31 02:07:47.306214 (Thread-209): 02:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c9e50>]}
2023-03-31 02:07:47.308155 (Thread-209): sending response (<Response 6761 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:47.497697 (Thread-210): handling poll request
2023-03-31 02:07:47.498137 (Thread-210): 02:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4610>]}
2023-03-31 02:07:47.498640 (Thread-210): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:47.690340 (Thread-211): handling status request
2023-03-31 02:07:47.690805 (Thread-211): 02:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c9eb0>]}
2023-03-31 02:07:47.691321 (Thread-211): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:47.746661 (Thread-212): handling ps request
2023-03-31 02:07:47.747075 (Thread-212): 02:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4700>]}
2023-03-31 02:07:47.747812 (Thread-212): sending response (<Response 6760 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:49.714919 (Thread-213): handling poll request
2023-03-31 02:07:49.715414 (Thread-213): 02:07:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c9fa0>]}
2023-03-31 02:07:49.715886 (Thread-213): sending response (<Response 471 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:49.909432 (Thread-214): handling status request
2023-03-31 02:07:49.909866 (Thread-214): 02:07:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d49a0>]}
2023-03-31 02:07:49.910342 (Thread-214): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:50.372053 (Thread-208): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:50.404219 (MainThread): 02:07:50  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0797249b-0971-4b0b-ab42-3561e4cf47f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158362ecd0>]}
2023-03-31 02:07:50.404803 (MainThread): 02:07:50  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:07:50.406165 (Thread-1): 02:07:50  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:07:50.406403 (Thread-1): 02:07:50  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:07:50.409396 (Thread-1): 02:07:50  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:07:50.406450 => 2023-03-31 02:07:50.409233
2023-03-31 02:07:50.409609 (Thread-1): 02:07:50  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:07:50.409773 (Thread-1): 02:07:50  Opening a new connection, currently in state init
2023-03-31 02:07:50.414514 (Thread-1): 02:07:50  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:07:50.626647 (Thread-215): handling ps request
2023-03-31 02:07:50.627101 (Thread-215): 02:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c9190>]}
2023-03-31 02:07:50.629516 (Thread-215): sending response (<Response 6756 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:50.633235 (Thread-216): handling ps request
2023-03-31 02:07:50.633532 (Thread-216): 02:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708be0>]}
2023-03-31 02:07:50.634134 (Thread-216): sending response (<Response 6756 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:50.889494 (Thread-217): handling status request
2023-03-31 02:07:50.889934 (Thread-217): 02:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708e20>]}
2023-03-31 02:07:50.890419 (Thread-217): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:50.951869 (Thread-218): handling poll request
2023-03-31 02:07:50.952299 (Thread-218): 02:07:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df708e80>]}
2023-03-31 02:07:50.952831 (Thread-218): sending response (<Response 4036 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:51.815244 (Thread-1): 02:07:51  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:18379565-49c5-41b1-8de4-270ec451b671&page=queryresults
2023-03-31 02:07:51.815727 (Thread-1): 02:07:51  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:07:50.409655 => 2023-03-31 02:07:51.815572
2023-03-31 02:07:51.916980 (Thread-219): handling poll request
2023-03-31 02:07:51.917426 (Thread-219): 02:07:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9d30>]}
2023-03-31 02:07:51.918019 (Thread-219): sending response (<Response 4898 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:52.110261 (Thread-220): handling status request
2023-03-31 02:07:52.110704 (Thread-220): 02:07:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df704d90>]}
2023-03-31 02:07:52.111199 (Thread-220): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:52.213460 (Thread-221): handling poll request
2023-03-31 02:07:52.213875 (Thread-221): 02:07:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6f9cd0>]}
2023-03-31 02:07:52.216058 (Thread-221): sending response (<Response 25270 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:52.866979 (Thread-222): handling ps request
2023-03-31 02:07:52.867431 (Thread-222): 02:07:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df753490>]}
2023-03-31 02:07:52.868228 (Thread-222): sending response (<Response 6781 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:53.062972 (Thread-223): handling status request
2023-03-31 02:07:53.063419 (Thread-223): 02:07:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7927c0>]}
2023-03-31 02:07:53.063894 (Thread-223): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:54.112638 (Thread-224): handling poll request
2023-03-31 02:07:54.113103 (Thread-224): 02:07:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df778e20>]}
2023-03-31 02:07:54.115158 (Thread-224): sending response (<Response 28841 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:54.691223 (Thread-225): handling status request
2023-03-31 02:07:54.691675 (Thread-225): 02:07:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7670>]}
2023-03-31 02:07:54.692192 (Thread-225): sending response (<Response 2710 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:07:54.699564 (Thread-226): handling ps request
2023-03-31 02:07:54.699869 (Thread-226): 02:07:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7e80>]}
2023-03-31 02:07:54.722182 (Thread-226): sending response (<Response 6781 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:09:46.976595 (Thread-227): 02:09:46  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:09:47.022834 (Thread-227): 02:09:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:09:47.023283 (Thread-227): 02:09:47  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:09:47.030896 (Thread-227): 02:09:47  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:09:47.067811 (Thread-227): 02:09:47  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:09:47.073479 (Thread-227): 02:09:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df558340>]}
2023-03-31 02:09:47.232454 (Thread-228): handling status request
2023-03-31 02:09:47.232905 (Thread-228): 02:09:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df585b20>]}
2023-03-31 02:09:47.233395 (Thread-228): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:10:42.088149 (Thread-229): 02:10:42  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:10:42.126108 (Thread-229): 02:10:42  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:10:42.126484 (Thread-229): 02:10:42  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:10:42.132307 (Thread-229): 02:10:42  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:10:42.170829 (Thread-229): 02:10:42  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:10:42.175938 (Thread-229): 02:10:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e95f40>]}
2023-03-31 02:10:42.406549 (Thread-230): handling status request
2023-03-31 02:10:42.406994 (Thread-230): 02:10:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6cff40>]}
2023-03-31 02:10:42.407488 (Thread-230): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:09.316749 (Thread-231): handling run_sql request
2023-03-31 02:11:09.317208 (Thread-231): 02:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df68bc40>]}
2023-03-31 02:11:09.332862 (Thread-232): handling ps request
2023-03-31 02:11:09.336164 (Thread-232): 02:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59abb0>]}
2023-03-31 02:11:09.338239 (Thread-232): sending response (<Response 7343 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:09.529533 (Thread-233): handling poll request
2023-03-31 02:11:09.529972 (Thread-233): 02:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c6c70>]}
2023-03-31 02:11:09.530494 (Thread-233): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:09.720751 (Thread-234): handling status request
2023-03-31 02:11:09.721198 (Thread-234): 02:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c6a30>]}
2023-03-31 02:11:09.721707 (Thread-234): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:09.790723 (Thread-235): handling ps request
2023-03-31 02:11:09.791161 (Thread-235): 02:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59ae50>]}
2023-03-31 02:11:09.791949 (Thread-235): sending response (<Response 7344 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:11.756260 (Thread-236): handling poll request
2023-03-31 02:11:11.756694 (Thread-236): 02:11:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c0670>]}
2023-03-31 02:11:11.757159 (Thread-236): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:11.945718 (Thread-237): handling status request
2023-03-31 02:11:11.946143 (Thread-237): 02:11:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59ac10>]}
2023-03-31 02:11:11.946600 (Thread-237): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:12.438883 (Thread-231): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:12.471000 (MainThread): 02:11:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '974e6144-4a18-479a-b26b-5c84869bfee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7814788b50>]}
2023-03-31 02:11:12.471584 (MainThread): 02:11:12  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:11:12.472957 (Thread-1): 02:11:12  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:11:12.473198 (Thread-1): 02:11:12  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:11:12.476234 (Thread-1): 02:11:12  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:11:12.473248 => 2023-03-31 02:11:12.476067
2023-03-31 02:11:12.476443 (Thread-1): 02:11:12  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:11:12.476621 (Thread-1): 02:11:12  Opening a new connection, currently in state init
2023-03-31 02:11:12.481422 (Thread-1): 02:11:12  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:11:12.690367 (Thread-238): handling ps request
2023-03-31 02:11:12.690785 (Thread-238): 02:11:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59a880>]}
2023-03-31 02:11:12.691680 (Thread-238): sending response (<Response 7339 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:12.697349 (Thread-239): handling ps request
2023-03-31 02:11:12.697669 (Thread-239): 02:11:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1a00>]}
2023-03-31 02:11:12.698333 (Thread-239): sending response (<Response 7339 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:13.046420 (Thread-240): handling status request
2023-03-31 02:11:13.046944 (Thread-240): 02:11:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1b50>]}
2023-03-31 02:11:13.047538 (Thread-240): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:13.121840 (Thread-241): handling poll request
2023-03-31 02:11:13.122282 (Thread-241): 02:11:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1bb0>]}
2023-03-31 02:11:13.122839 (Thread-241): sending response (<Response 4095 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:13.960120 (Thread-242): handling poll request
2023-03-31 02:11:13.960608 (Thread-242): 02:11:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59a880>]}
2023-03-31 02:11:13.961180 (Thread-242): sending response (<Response 4095 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:14.048336 (Thread-1): 02:11:14  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:96df8797-6962-434f-bdd4-a1556bd70f17&page=queryresults
2023-03-31 02:11:14.048857 (Thread-1): 02:11:14  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:11:12.476490 => 2023-03-31 02:11:14.048679
2023-03-31 02:11:14.168723 (Thread-243): handling status request
2023-03-31 02:11:14.169254 (Thread-243): 02:11:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1460>]}
2023-03-31 02:11:14.169805 (Thread-243): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:14.313424 (Thread-244): handling poll request
2023-03-31 02:11:14.313873 (Thread-244): 02:11:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1430>]}
2023-03-31 02:11:14.314372 (Thread-244): sending response (<Response 1327 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:15.025090 (Thread-245): handling ps request
2023-03-31 02:11:15.025540 (Thread-245): 02:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed13d0>]}
2023-03-31 02:11:15.026315 (Thread-245): sending response (<Response 7364 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:15.216514 (Thread-246): handling status request
2023-03-31 02:11:15.216959 (Thread-246): 02:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2ed1f10>]}
2023-03-31 02:11:15.217432 (Thread-246): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:15.536274 (Thread-247): handling poll request
2023-03-31 02:11:15.536717 (Thread-247): 02:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4160>]}
2023-03-31 02:11:15.538916 (Thread-247): sending response (<Response 27893 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:16.164906 (Thread-248): handling poll request
2023-03-31 02:11:16.165361 (Thread-248): 02:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4520>]}
2023-03-31 02:11:16.167419 (Thread-248): sending response (<Response 32383 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:16.827867 (Thread-249): handling ps request
2023-03-31 02:11:16.828398 (Thread-249): 02:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4c70>]}
2023-03-31 02:11:16.829224 (Thread-249): sending response (<Response 7364 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:16.954966 (Thread-250): handling status request
2023-03-31 02:11:16.955424 (Thread-250): 02:11:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6d4520>]}
2023-03-31 02:11:16.955911 (Thread-250): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:38.708479 (Thread-251): handling run_sql request
2023-03-31 02:11:38.708998 (Thread-251): 02:11:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c0df0>]}
2023-03-31 02:11:38.727338 (Thread-252): handling ps request
2023-03-31 02:11:38.729338 (Thread-252): 02:11:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6c6f70>]}
2023-03-31 02:11:38.731470 (Thread-252): sending response (<Response 7927 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:38.929074 (Thread-253): handling poll request
2023-03-31 02:11:38.929521 (Thread-253): 02:11:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7670>]}
2023-03-31 02:11:38.930036 (Thread-253): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:39.148159 (Thread-254): handling status request
2023-03-31 02:11:39.148605 (Thread-254): 02:11:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6a7340>]}
2023-03-31 02:11:39.149248 (Thread-254): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:39.191623 (Thread-255): handling ps request
2023-03-31 02:11:39.192005 (Thread-255): 02:11:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59a970>]}
2023-03-31 02:11:39.192819 (Thread-255): sending response (<Response 7927 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:41.146318 (Thread-256): handling poll request
2023-03-31 02:11:41.146796 (Thread-256): 02:11:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df6cf760>]}
2023-03-31 02:11:41.173923 (Thread-256): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:41.368693 (Thread-257): handling status request
2023-03-31 02:11:41.369149 (Thread-257): 02:11:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfae6af0>]}
2023-03-31 02:11:41.369626 (Thread-257): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:41.798913 (Thread-251): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:41.830833 (MainThread): 02:11:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58a576f-dfd6-43a3-b1da-06f6c4e8ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7e76db20>]}
2023-03-31 02:11:41.831423 (MainThread): 02:11:41  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:11:41.832787 (Thread-1): 02:11:41  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:11:41.833034 (Thread-1): 02:11:41  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:11:41.836064 (Thread-1): 02:11:41  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:11:41.833083 => 2023-03-31 02:11:41.835878
2023-03-31 02:11:41.836277 (Thread-1): 02:11:41  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:11:41.836451 (Thread-1): 02:11:41  Opening a new connection, currently in state init
2023-03-31 02:11:41.841265 (Thread-1): 02:11:41  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(rn as string) as ndvi_id,
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:11:41.983540 (Thread-258): handling ps request
2023-03-31 02:11:41.984020 (Thread-258): 02:11:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df59abe0>]}
2023-03-31 02:11:41.984872 (Thread-258): sending response (<Response 7922 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:41.991048 (Thread-259): handling ps request
2023-03-31 02:11:41.991355 (Thread-259): 02:11:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df5621f0>]}
2023-03-31 02:11:41.992051 (Thread-259): sending response (<Response 7922 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:42.371262 (Thread-260): handling status request
2023-03-31 02:11:42.371703 (Thread-260): 02:11:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dfae66d0>]}
2023-03-31 02:11:42.372228 (Thread-260): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:42.377673 (Thread-261): handling poll request
2023-03-31 02:11:42.377980 (Thread-261): 02:11:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df562250>]}
2023-03-31 02:11:42.378440 (Thread-261): sending response (<Response 4131 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:43.347294 (Thread-1): 02:11:43  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:38301d4b-d76b-4a02-aca4-8c7019ed82b8&page=queryresults
2023-03-31 02:11:43.347792 (Thread-1): 02:11:43  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:11:41.836323 => 2023-03-31 02:11:43.347620
2023-03-31 02:11:43.372656 (Thread-262): handling poll request
2023-03-31 02:11:43.373113 (Thread-262): 02:11:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df585220>]}
2023-03-31 02:11:43.373699 (Thread-262): sending response (<Response 4993 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:43.568891 (Thread-263): handling status request
2023-03-31 02:11:43.569355 (Thread-263): 02:11:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df5851f0>]}
2023-03-31 02:11:43.569830 (Thread-263): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:43.677100 (Thread-264): handling poll request
2023-03-31 02:11:43.677538 (Thread-264): 02:11:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df585520>]}
2023-03-31 02:11:43.679774 (Thread-264): sending response (<Response 29679 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:44.254332 (Thread-265): handling ps request
2023-03-31 02:11:44.254782 (Thread-265): 02:11:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e93640>]}
2023-03-31 02:11:44.255593 (Thread-265): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:44.446473 (Thread-266): handling status request
2023-03-31 02:11:44.446922 (Thread-266): 02:11:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e93370>]}
2023-03-31 02:11:44.447393 (Thread-266): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:45.570115 (Thread-267): handling poll request
2023-03-31 02:11:45.570565 (Thread-267): 02:11:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e93670>]}
2023-03-31 02:11:45.572750 (Thread-267): sending response (<Response 33345 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:46.194231 (Thread-268): handling status request
2023-03-31 02:11:46.194677 (Thread-268): 02:11:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e93e80>]}
2023-03-31 02:11:46.195168 (Thread-268): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:11:46.209327 (Thread-269): handling ps request
2023-03-31 02:11:46.209653 (Thread-269): 02:11:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e936d0>]}
2023-03-31 02:11:46.210384 (Thread-269): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:12:38.990683 (Thread-270): handling status request
2023-03-31 02:12:38.991135 (Thread-270): 02:12:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e933d0>]}
2023-03-31 02:12:38.991612 (Thread-270): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:13:06.451682 (Thread-271): 02:13:06  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:13:06.497066 (Thread-271): 02:13:06  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:13:06.497522 (Thread-271): 02:13:06  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:13:06.504037 (Thread-271): 02:13:06  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 02:13:06.682393 (Thread-272): handling status request
2023-03-31 02:13:06.682894 (Thread-272): 02:13:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d22a30>]}
2023-03-31 02:13:06.683378 (Thread-272): sending response (<Response 1783 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:13:48.075496 (Thread-273): handling status request
2023-03-31 02:13:48.075944 (Thread-273): 02:13:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d227f0>]}
2023-03-31 02:13:48.076440 (Thread-273): sending response (<Response 1783 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:13:57.496360 (Thread-274): 02:13:57  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:13:57.534400 (Thread-274): 02:13:57  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:13:57.534814 (Thread-274): 02:13:57  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:13:57.542089 (Thread-274): 02:13:57  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 02:13:57.888826 (Thread-275): handling status request
2023-03-31 02:13:57.889291 (Thread-275): 02:13:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdf7f40>]}
2023-03-31 02:13:57.889773 (Thread-275): sending response (<Response 1783 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:03.304045 (Thread-277): handling status request
2023-03-31 02:14:03.304578 (Thread-277): 02:14:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e6b8e0>]}
2023-03-31 02:14:03.305038 (Thread-277): sending response (<Response 356 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:13.500111 (Thread-278): handling status request
2023-03-31 02:14:13.500578 (Thread-278): 02:14:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02d90>]}
2023-03-31 02:14:13.501015 (Thread-278): sending response (<Response 356 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:13.507628 (Thread-279): handling ps request
2023-03-31 02:14:13.507925 (Thread-279): 02:14:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe78160>]}
2023-03-31 02:14:13.508669 (Thread-279): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:17.855741 (Thread-280): handling status request
2023-03-31 02:14:17.856212 (Thread-280): 02:14:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe78250>]}
2023-03-31 02:14:17.856626 (Thread-280): sending response (<Response 356 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:17.871555 (Thread-281): handling ps request
2023-03-31 02:14:17.871853 (Thread-281): 02:14:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe78130>]}
2023-03-31 02:14:17.872582 (Thread-281): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:18.293384 (Thread-282): handling status request
2023-03-31 02:14:18.293835 (Thread-282): 02:14:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe781f0>]}
2023-03-31 02:14:18.294252 (Thread-282): sending response (<Response 356 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:34.814684 (Thread-283): handling ps request
2023-03-31 02:14:34.815192 (Thread-283): 02:14:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e93100>]}
2023-03-31 02:14:34.816053 (Thread-283): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:34.819291 (Thread-284): handling ps request
2023-03-31 02:14:34.819613 (Thread-284): 02:14:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe786a0>]}
2023-03-31 02:14:34.820381 (Thread-284): sending response (<Response 7947 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:34.924631 (Thread-285): handling status request
2023-03-31 02:14:34.925086 (Thread-285): 02:14:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfddd610>]}
2023-03-31 02:14:34.925505 (Thread-285): sending response (<Response 356 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:35.256789 (Thread-286): handling deps request
2023-03-31 02:14:35.257252 (Thread-286): 02:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfddd6d0>]}
2023-03-31 02:14:35.298457 (Thread-286): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:35.559948 (Thread-287): handling status request
2023-03-31 02:14:35.560603 (Thread-287): 02:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdf7fa0>]}
2023-03-31 02:14:35.561255 (Thread-287): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:35.811368 (Thread-288): handling ps request
2023-03-31 02:14:35.811850 (Thread-288): 02:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdf7d30>]}
2023-03-31 02:14:35.813037 (Thread-288): sending response (<Response 8313 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:35.897367 (Thread-289): handling poll request
2023-03-31 02:14:35.897787 (Thread-289): 02:14:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0cc40>]}
2023-03-31 02:14:35.921468 (Thread-289): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:36.104963 (Thread-290): handling status request
2023-03-31 02:14:36.105411 (Thread-290): 02:14:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e91640>]}
2023-03-31 02:14:36.105854 (Thread-290): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:36.394384 (Thread-291): handling ps request
2023-03-31 02:14:36.394819 (Thread-291): 02:14:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0cfa0>]}
2023-03-31 02:14:36.395654 (Thread-291): sending response (<Response 8313 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:36.904159 (Thread-292): handling status request
2023-03-31 02:14:36.904616 (Thread-292): 02:14:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0c760>]}
2023-03-31 02:14:36.905047 (Thread-292): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:37.350795 (Thread-293): handling poll request
2023-03-31 02:14:37.351239 (Thread-293): 02:14:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0c7c0>]}
2023-03-31 02:14:37.351699 (Thread-293): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:37.680234 (Thread-294): handling status request
2023-03-31 02:14:37.680677 (Thread-294): 02:14:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0ca60>]}
2023-03-31 02:14:37.681091 (Thread-294): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:38.413194 (MainThread): 02:14:38  Set downloads directory='/tmp/dbt-downloads-qpkl6d95'
2023-03-31 02:14:38.413885 (MainThread): 02:14:38  Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
2023-03-31 02:14:38.439055 (MainThread): 02:14:38  Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
2023-03-31 02:14:38.439410 (MainThread): 02:14:38  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2023-03-31 02:14:38.453705 (MainThread): 02:14:38  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2023-03-31 02:14:38.462843 (MainThread): 02:14:38  Installing dbt-labs/dbt_utils
2023-03-31 02:14:38.524157 (Thread-295): handling status request
2023-03-31 02:14:38.524584 (Thread-295): 02:14:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0ce20>]}
2023-03-31 02:14:38.525005 (Thread-295): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:38.596062 (Thread-296): handling poll request
2023-03-31 02:14:38.596506 (Thread-296): 02:14:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0c340>]}
2023-03-31 02:14:38.597038 (Thread-296): sending response (<Response 2163 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:38.869499 (Thread-297): handling ps request
2023-03-31 02:14:38.869929 (Thread-297): 02:14:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02f10>]}
2023-03-31 02:14:38.870784 (Thread-297): sending response (<Response 8313 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:39.060425 (Thread-298): handling status request
2023-03-31 02:14:39.060868 (Thread-298): 02:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe026d0>]}
2023-03-31 02:14:39.061287 (Thread-298): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:39.785508 (Thread-299): handling status request
2023-03-31 02:14:39.785979 (Thread-299): 02:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02550>]}
2023-03-31 02:14:39.786399 (Thread-299): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:39.875143 (Thread-300): handling poll request
2023-03-31 02:14:39.875571 (Thread-300): 02:14:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02190>]}
2023-03-31 02:14:39.876062 (Thread-300): sending response (<Response 277 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:40.475808 (Thread-301): handling status request
2023-03-31 02:14:40.476290 (Thread-301): 02:14:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe021c0>]}
2023-03-31 02:14:40.476714 (Thread-301): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:41.100751 (Thread-302): handling ps request
2023-03-31 02:14:41.101205 (Thread-302): 02:14:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02220>]}
2023-03-31 02:14:41.102048 (Thread-302): sending response (<Response 8313 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:41.151744 (Thread-303): handling poll request
2023-03-31 02:14:41.152128 (Thread-303): 02:14:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe02520>]}
2023-03-31 02:14:41.152561 (Thread-303): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:41.165206 (Thread-304): handling status request
2023-03-31 02:14:41.165502 (Thread-304): 02:14:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe85460>]}
2023-03-31 02:14:41.165832 (Thread-304): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:41.866321 (Thread-305): handling status request
2023-03-31 02:14:41.866775 (Thread-305): 02:14:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe85130>]}
2023-03-31 02:14:41.867181 (Thread-305): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:42.355937 (Thread-306): handling poll request
2023-03-31 02:14:42.356406 (Thread-306): 02:14:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe85520>]}
2023-03-31 02:14:42.356869 (Thread-306): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:42.553929 (Thread-307): handling status request
2023-03-31 02:14:42.554437 (Thread-307): 02:14:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe0c4c0>]}
2023-03-31 02:14:42.554854 (Thread-307): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:42.557032 (MainThread): 02:14:42    Installed from version 0.8.0
2023-03-31 02:14:42.557242 (MainThread): 02:14:42    Updated version available: 1.0.0
2023-03-31 02:14:42.557447 (MainThread): 02:14:42  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f5ab40ab-2cfc-4018-a3c4-5d137217376c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f882396ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f882396e790>]}
2023-03-31 02:14:42.557719 (MainThread): 02:14:42  
2023-03-31 02:14:42.557867 (MainThread): 02:14:42  Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2023-03-31 02:14:42.870865 (99417aa9-5b37-4c81-9a9d-a1355d166cb0-handler-deps): 02:14:42  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:14:42.882158 (99417aa9-5b37-4c81-9a9d-a1355d166cb0-handler-deps): 02:14:42  Unable to do partial parsing because a project dependency has been added
2023-03-31 02:14:42.882482 (99417aa9-5b37-4c81-9a9d-a1355d166cb0-handler-deps): 02:14:42  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df558ca0>]}
2023-03-31 02:14:43.337316 (Thread-308): handling status request
2023-03-31 02:14:43.353080 (Thread-308): 02:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d1f1f0>]}
2023-03-31 02:14:43.358672 (Thread-308): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:43.390469 (Thread-309): handling ps request
2023-03-31 02:14:43.401130 (Thread-309): 02:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfebaf40>]}
2023-03-31 02:14:43.407057 (Thread-309): sending response (<Response 8313 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:43.552382 (Thread-310): handling poll request
2023-03-31 02:14:43.578245 (Thread-310): 02:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe07130>]}
2023-03-31 02:14:43.583878 (Thread-310): sending response (<Response 1999 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:43.722162 (Thread-311): handling status request
2023-03-31 02:14:43.742981 (Thread-311): 02:14:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfe3aca0>]}
2023-03-31 02:14:43.753624 (Thread-311): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:44.126047 (99417aa9-5b37-4c81-9a9d-a1355d166cb0-handler-deps): 02:14:44  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 02:14:44.513112 (Thread-312): handling status request
2023-03-31 02:14:44.513590 (Thread-312): 02:14:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd63940>]}
2023-03-31 02:14:44.514151 (Thread-312): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:44.817554 (Thread-313): handling poll request
2023-03-31 02:14:44.818000 (Thread-313): 02:14:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd63580>]}
2023-03-31 02:14:44.818458 (Thread-313): sending response (<Response 1452 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:46.113083 (Thread-314): handling ps request
2023-03-31 02:14:46.113530 (Thread-314): 02:14:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd63fd0>]}
2023-03-31 02:14:46.114399 (Thread-314): sending response (<Response 8336 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:14:46.526833 (Thread-315): handling status request
2023-03-31 02:14:46.527277 (Thread-315): 02:14:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd671f0>]}
2023-03-31 02:14:46.527865 (Thread-315): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:03.518642 (Thread-316): handling status request
2023-03-31 02:15:03.519093 (Thread-316): 02:15:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd67310>]}
2023-03-31 02:15:03.519624 (Thread-316): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:03.541636 (Thread-317): handling ps request
2023-03-31 02:15:03.541976 (Thread-317): 02:15:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd67400>]}
2023-03-31 02:15:03.542768 (Thread-317): sending response (<Response 8336 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:04.214920 (Thread-318): handling status request
2023-03-31 02:15:04.215379 (Thread-318): 02:15:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd67580>]}
2023-03-31 02:15:04.239438 (Thread-318): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:08.008369 (Thread-319): handling status request
2023-03-31 02:15:08.008863 (Thread-319): 02:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd63bb0>]}
2023-03-31 02:15:08.009401 (Thread-319): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:08.065963 (Thread-320): handling ps request
2023-03-31 02:15:08.066388 (Thread-320): 02:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd67640>]}
2023-03-31 02:15:08.067221 (Thread-320): sending response (<Response 8336 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:08.620115 (Thread-321): handling status request
2023-03-31 02:15:08.620574 (Thread-321): 02:15:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd67d30>]}
2023-03-31 02:15:08.621128 (Thread-321): sending response (<Response 4058 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:18.369989 (Thread-322): 02:15:18  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:15:18.380757 (Thread-322): 02:15:18  Unable to do partial parsing because a project dependency has been added
2023-03-31 02:15:18.381108 (Thread-322): 02:15:18  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df7e6850>]}
2023-03-31 02:15:18.653107 (Thread-323): handling status request
2023-03-31 02:15:18.679023 (Thread-323): 02:15:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdec580>]}
2023-03-31 02:15:18.689675 (Thread-323): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:19.678875 (Thread-322): 02:15:19  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:15:19.784961 (Thread-322): 02:15:19  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:15:19.790918 (Thread-322): 02:15:19  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df63ae80>]}
2023-03-31 02:15:20.552475 (Thread-324): handling status request
2023-03-31 02:15:20.552980 (Thread-324): 02:15:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd7a130>]}
2023-03-31 02:15:20.553492 (Thread-324): sending response (<Response 2512 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:23.722011 (Thread-325): 02:15:23  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:15:23.843199 (Thread-325): 02:15:23  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:15:23.843624 (Thread-325): 02:15:23  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:15:23.850622 (Thread-325): 02:15:23  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:15:23.897993 (Thread-325): 02:15:23  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:15:23.903768 (Thread-325): 02:15:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdc7880>]}
2023-03-31 02:15:23.972385 (Thread-326): handling status request
2023-03-31 02:15:23.972860 (Thread-326): 02:15:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df5f1a60>]}
2023-03-31 02:15:23.973349 (Thread-326): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:26.806105 (Thread-327): handling run_sql request
2023-03-31 02:15:26.806574 (Thread-327): 02:15:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df5f1790>]}
2023-03-31 02:15:26.823347 (Thread-328): handling ps request
2023-03-31 02:15:26.827555 (Thread-328): 02:15:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8550>]}
2023-03-31 02:15:26.829867 (Thread-328): sending response (<Response 8899 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:27.122144 (Thread-329): handling poll request
2023-03-31 02:15:27.122587 (Thread-329): 02:15:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8fd0>]}
2023-03-31 02:15:27.123105 (Thread-329): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:27.312780 (Thread-330): handling status request
2023-03-31 02:15:27.313261 (Thread-330): 02:15:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8280>]}
2023-03-31 02:15:27.313799 (Thread-330): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:27.450852 (Thread-331): handling ps request
2023-03-31 02:15:27.451276 (Thread-331): 02:15:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8fa0>]}
2023-03-31 02:15:27.452152 (Thread-331): sending response (<Response 8899 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:29.363611 (Thread-332): handling poll request
2023-03-31 02:15:29.364124 (Thread-332): 02:15:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8310>]}
2023-03-31 02:15:29.364611 (Thread-332): sending response (<Response 471 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:29.553488 (Thread-333): handling status request
2023-03-31 02:15:29.553933 (Thread-333): 02:15:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8af0>]}
2023-03-31 02:15:29.554398 (Thread-333): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:29.950504 (Thread-327): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:29.983993 (MainThread): 02:15:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '640e0cd0-6228-48e1-9f9b-b22aba23bbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb92cbc8640>]}
2023-03-31 02:15:29.984577 (MainThread): 02:15:29  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:15:29.985949 (Thread-1): 02:15:29  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:15:29.986188 (Thread-1): 02:15:29  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:15:29.989441 (Thread-1): 02:15:29  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:15:29.986236 => 2023-03-31 02:15:29.989276
2023-03-31 02:15:29.989657 (Thread-1): 02:15:29  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:15:29.989820 (Thread-1): 02:15:29  Opening a new connection, currently in state init
2023-03-31 02:15:29.994562 (Thread-1): 02:15:29  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:15:30.268722 (Thread-334): handling ps request
2023-03-31 02:15:30.269191 (Thread-334): 02:15:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8d60>]}
2023-03-31 02:15:30.270136 (Thread-334): sending response (<Response 8894 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:30.277253 (Thread-335): handling ps request
2023-03-31 02:15:30.277579 (Thread-335): 02:15:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8ca0>]}
2023-03-31 02:15:30.278333 (Thread-335): sending response (<Response 8894 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:30.513971 (Thread-336): handling status request
2023-03-31 02:15:30.514417 (Thread-336): 02:15:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8430>]}
2023-03-31 02:15:30.514892 (Thread-336): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:30.642544 (Thread-337): handling poll request
2023-03-31 02:15:30.643006 (Thread-337): 02:15:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8d00>]}
2023-03-31 02:15:30.643598 (Thread-337): sending response (<Response 4095 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:31.055172 (Thread-1): 02:15:31  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:3de43e47-c013-4759-aeb4-ec081d271088&page=queryresults
2023-03-31 02:15:31.055670 (Thread-1): 02:15:31  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:15:29.989702 => 2023-03-31 02:15:31.055506
2023-03-31 02:15:31.600424 (Thread-338): handling poll request
2023-03-31 02:15:31.600868 (Thread-338): 02:15:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df64e790>]}
2023-03-31 02:15:31.603200 (Thread-338): sending response (<Response 32384 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:32.221854 (Thread-339): handling status request
2023-03-31 02:15:32.222291 (Thread-339): 02:15:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e4d3a0>]}
2023-03-31 02:15:32.222763 (Thread-339): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:32.308308 (Thread-340): handling ps request
2023-03-31 02:15:32.308755 (Thread-340): 02:15:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e4d820>]}
2023-03-31 02:15:32.309578 (Thread-340): sending response (<Response 8919 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:32.604079 (Thread-341): handling poll request
2023-03-31 02:15:32.604539 (Thread-341): 02:15:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8730>]}
2023-03-31 02:15:32.606621 (Thread-341): sending response (<Response 28754 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:33.188044 (Thread-342): handling ps request
2023-03-31 02:15:33.188493 (Thread-342): 02:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8df0>]}
2023-03-31 02:15:33.189356 (Thread-342): sending response (<Response 8919 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:33.413094 (Thread-343): handling status request
2023-03-31 02:15:33.413612 (Thread-343): 02:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df5a1910>]}
2023-03-31 02:15:33.414117 (Thread-343): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:41.361032 (Thread-344): handling ps request
2023-03-31 02:15:41.361487 (Thread-344): 02:15:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2e4dfa0>]}
2023-03-31 02:15:41.362346 (Thread-344): sending response (<Response 8919 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:41.367904 (Thread-345): handling status request
2023-03-31 02:15:41.368253 (Thread-345): 02:15:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d5c820>]}
2023-03-31 02:15:41.368668 (Thread-345): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:41.415897 (Thread-346): handling ps request
2023-03-31 02:15:41.416339 (Thread-346): 02:15:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2db8430>]}
2023-03-31 02:15:41.417190 (Thread-346): sending response (<Response 8919 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:42.183350 (Thread-347): handling deps request
2023-03-31 02:15:42.183855 (Thread-347): 02:15:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfdc7820>]}
2023-03-31 02:15:42.249752 (Thread-347): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:42.729919 (Thread-348): handling status request
2023-03-31 02:15:42.730563 (Thread-348): 02:15:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29250>]}
2023-03-31 02:15:42.731216 (Thread-348): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:43.139837 (Thread-349): handling ps request
2023-03-31 02:15:43.140327 (Thread-349): 02:15:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd292e0>]}
2023-03-31 02:15:43.141534 (Thread-349): sending response (<Response 9285 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:43.234719 (Thread-350): handling poll request
2023-03-31 02:15:43.235164 (Thread-350): 02:15:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29130>]}
2023-03-31 02:15:43.235675 (Thread-350): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:43.391445 (Thread-351): handling status request
2023-03-31 02:15:43.391899 (Thread-351): 02:15:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29a00>]}
2023-03-31 02:15:43.392340 (Thread-351): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:44.287182 (Thread-352): handling status request
2023-03-31 02:15:44.287637 (Thread-352): 02:15:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd299a0>]}
2023-03-31 02:15:44.288083 (Thread-352): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:44.767680 (Thread-353): handling poll request
2023-03-31 02:15:44.768156 (Thread-353): 02:15:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29a60>]}
2023-03-31 02:15:44.768644 (Thread-353): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:44.983814 (Thread-354): handling status request
2023-03-31 02:15:44.984279 (Thread-354): 02:15:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29520>]}
2023-03-31 02:15:44.984686 (Thread-354): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:45.386826 (Thread-355): handling ps request
2023-03-31 02:15:45.387331 (Thread-355): 02:15:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d5c820>]}
2023-03-31 02:15:45.388285 (Thread-355): sending response (<Response 9285 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:45.584690 (Thread-356): handling status request
2023-03-31 02:15:45.585166 (Thread-356): 02:15:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29df0>]}
2023-03-31 02:15:45.585594 (Thread-356): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:45.979555 (Thread-357): handling poll request
2023-03-31 02:15:45.980017 (Thread-357): 02:15:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29b20>]}
2023-03-31 02:15:45.980493 (Thread-357): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:46.287491 (Thread-358): handling status request
2023-03-31 02:15:46.287928 (Thread-358): 02:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29eb0>]}
2023-03-31 02:15:46.288366 (Thread-358): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:46.304726 (MainThread): 02:15:46  Set downloads directory='/tmp/dbt-downloads-v9jis_hy'
2023-03-31 02:15:46.305468 (MainThread): 02:15:46  Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
2023-03-31 02:15:46.383911 (MainThread): 02:15:46  Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
2023-03-31 02:15:46.384323 (MainThread): 02:15:46  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2023-03-31 02:15:46.456330 (MainThread): 02:15:46  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2023-03-31 02:15:46.465569 (MainThread): 02:15:46  Installing dbt-labs/dbt_utils
2023-03-31 02:15:46.982376 (Thread-359): handling status request
2023-03-31 02:15:46.982823 (Thread-359): 02:15:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd19fd0>]}
2023-03-31 02:15:46.983235 (Thread-359): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:47.306311 (Thread-360): handling poll request
2023-03-31 02:15:47.306755 (Thread-360): 02:15:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd192b0>]}
2023-03-31 02:15:47.307289 (Thread-360): sending response (<Response 2163 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:47.577868 (Thread-361): handling ps request
2023-03-31 02:15:47.579010 (Thread-361): 02:15:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9da72e0>]}
2023-03-31 02:15:47.579893 (Thread-361): sending response (<Response 9285 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:47.678122 (Thread-362): handling status request
2023-03-31 02:15:47.678563 (Thread-362): 02:15:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd298e0>]}
2023-03-31 02:15:47.678975 (Thread-362): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:48.405364 (Thread-363): handling status request
2023-03-31 02:15:48.405830 (Thread-363): 02:15:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29c10>]}
2023-03-31 02:15:48.406265 (Thread-363): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:48.594441 (Thread-364): handling poll request
2023-03-31 02:15:48.594923 (Thread-364): 02:15:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29610>]}
2023-03-31 02:15:48.595389 (Thread-364): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:49.106954 (Thread-365): handling status request
2023-03-31 02:15:49.107400 (Thread-365): 02:15:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29550>]}
2023-03-31 02:15:49.107816 (Thread-365): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:49.854832 (Thread-366): handling status request
2023-03-31 02:15:49.855283 (Thread-366): 02:15:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd29850>]}
2023-03-31 02:15:49.855775 (Thread-366): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:49.862913 (Thread-367): handling poll request
2023-03-31 02:15:49.863230 (Thread-367): 02:15:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd2d7c0>]}
2023-03-31 02:15:49.863628 (Thread-367): sending response (<Response 278 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:49.934251 (Thread-368): handling ps request
2023-03-31 02:15:49.934691 (Thread-368): 02:15:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd2dcd0>]}
2023-03-31 02:15:49.935599 (Thread-368): sending response (<Response 9285 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:50.184078 (Thread-369): handling status request
2023-03-31 02:15:50.184521 (Thread-369): 02:15:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd1f8e0>]}
2023-03-31 02:15:50.184951 (Thread-369): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:50.430755 (MainThread): 02:15:50    Installed from version 0.8.0
2023-03-31 02:15:50.430971 (MainThread): 02:15:50    Updated version available: 1.0.0
2023-03-31 02:15:50.431185 (MainThread): 02:15:50  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a1741809-faf8-4406-b5d3-c2b197954a40', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf3cf9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf3cf9a30>]}
2023-03-31 02:15:50.431467 (MainThread): 02:15:50  
2023-03-31 02:15:50.431604 (MainThread): 02:15:50  Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2023-03-31 02:15:50.729386 (446f50b9-3529-4044-9069-dfc47c4d761b-handler-deps): 02:15:50  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:15:50.916839 (Thread-370): handling status request
2023-03-31 02:15:50.917359 (Thread-370): 02:15:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb66db20>]}
2023-03-31 02:15:50.917779 (Thread-370): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:50.979189 (446f50b9-3529-4044-9069-dfc47c4d761b-handler-deps): 02:15:50  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2023-03-31 02:15:50.979401 (446f50b9-3529-4044-9069-dfc47c4d761b-handler-deps): 02:15:50  Partial parsing enabled, no changes found, skipping parsing
2023-03-31 02:15:50.980174 (446f50b9-3529-4044-9069-dfc47c4d761b-handler-deps): 02:15:50  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:15:50.986599 (446f50b9-3529-4044-9069-dfc47c4d761b-handler-deps): 02:15:50  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b95e0>]}
2023-03-31 02:15:51.221327 (Thread-371): handling poll request
2023-03-31 02:15:51.221748 (Thread-371): 02:15:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb665220>]}
2023-03-31 02:15:51.222331 (Thread-371): sending response (<Response 2072 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:51.652956 (Thread-372): handling status request
2023-03-31 02:15:51.653409 (Thread-372): 02:15:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6652b0>]}
2023-03-31 02:15:51.653956 (Thread-372): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:52.228453 (Thread-373): handling ps request
2023-03-31 02:15:52.228910 (Thread-373): 02:15:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb66db20>]}
2023-03-31 02:15:52.229807 (Thread-373): sending response (<Response 9310 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:15:52.428005 (Thread-374): handling status request
2023-03-31 02:15:52.428438 (Thread-374): 02:15:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb66dbe0>]}
2023-03-31 02:15:52.428963 (Thread-374): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:21.233615 (Thread-375): handling run_sql request
2023-03-31 02:16:21.234073 (Thread-375): 02:16:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb66db50>]}
2023-03-31 02:16:21.240158 (Thread-376): handling ps request
2023-03-31 02:16:21.249045 (Thread-376): 02:16:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9cd0>]}
2023-03-31 02:16:21.286104 (Thread-376): sending response (<Response 9872 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:21.476545 (Thread-377): handling poll request
2023-03-31 02:16:21.477010 (Thread-377): 02:16:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9ac0>]}
2023-03-31 02:16:21.477537 (Thread-377): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:21.670156 (Thread-378): handling status request
2023-03-31 02:16:21.670601 (Thread-378): 02:16:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a98e0>]}
2023-03-31 02:16:21.671164 (Thread-378): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:21.762153 (Thread-379): handling ps request
2023-03-31 02:16:21.762588 (Thread-379): 02:16:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9820>]}
2023-03-31 02:16:21.763507 (Thread-379): sending response (<Response 9873 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:23.687925 (Thread-380): handling poll request
2023-03-31 02:16:23.688395 (Thread-380): 02:16:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9310>]}
2023-03-31 02:16:23.688866 (Thread-380): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:23.879922 (Thread-381): handling status request
2023-03-31 02:16:23.880388 (Thread-381): 02:16:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a98b0>]}
2023-03-31 02:16:23.880889 (Thread-381): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:24.322748 (Thread-375): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:24.344333 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 768, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<unknown>", line 12, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'as'
  line 12
    {{ dbt_utils.surrogate_key(['study_area', cast(SPLIT(image, '/')[OFFSET(5)] as string)) }} as image_id,

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 166, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    rpc_node = rpc_parser.parse_remote(sql, self.args.name, self.args.language)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/parser/rpc.py", line 47, in parse_remote
    return self.parse_node(contents)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 386, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 362, in render_update
    context = self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 240, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 583, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    raise CompilationError(str(e), node) from e
dbt.exceptions.CompilationError: Compilation Error in rpc request (from remote system.sql)
  expected token ',', got 'as'
    line 12
      {{ dbt_utils.surrogate_key(['study_area', cast(SPLIT(image, '/')[OFFSET(5)] as string)) }} as image_id,
2023-03-31 02:16:24.578053 (Thread-382): handling ps request
2023-03-31 02:16:24.578562 (Thread-382): 02:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd19dc0>]}
2023-03-31 02:16:24.579495 (Thread-382): sending response (<Response 9868 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:24.584765 (Thread-383): handling ps request
2023-03-31 02:16:24.585091 (Thread-383): 02:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9820>]}
2023-03-31 02:16:24.585859 (Thread-383): sending response (<Response 9868 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:24.775145 (Thread-384): handling status request
2023-03-31 02:16:24.775574 (Thread-384): 02:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9820>]}
2023-03-31 02:16:24.776110 (Thread-384): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:24.892530 (Thread-385): handling poll request
2023-03-31 02:16:24.892989 (Thread-385): 02:16:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9cd0>]}
2023-03-31 02:16:24.893477 (Thread-385): sending response (<Response 4912 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:25.894797 (Thread-386): handling poll request
2023-03-31 02:16:25.895264 (Thread-386): 02:16:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd21220>]}
2023-03-31 02:16:25.895763 (Thread-386): sending response (<Response 4912 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:26.506010 (Thread-387): handling status request
2023-03-31 02:16:26.506461 (Thread-387): 02:16:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9d90>]}
2023-03-31 02:16:26.506982 (Thread-387): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:26.947831 (Thread-388): handling ps request
2023-03-31 02:16:26.948314 (Thread-388): 02:16:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9e20>]}
2023-03-31 02:16:26.949227 (Thread-388): sending response (<Response 9891 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:27.135375 (Thread-389): handling status request
2023-03-31 02:16:27.135821 (Thread-389): 02:16:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9f10>]}
2023-03-31 02:16:27.136349 (Thread-389): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:50.120349 (Thread-390): handling run_sql request
2023-03-31 02:16:50.120805 (Thread-390): 02:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9fa0>]}
2023-03-31 02:16:50.128722 (Thread-391): handling ps request
2023-03-31 02:16:50.137701 (Thread-391): 02:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbd90>]}
2023-03-31 02:16:50.153152 (Thread-391): sending response (<Response 10454 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:50.349647 (Thread-392): handling poll request
2023-03-31 02:16:50.350103 (Thread-392): 02:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbf70>]}
2023-03-31 02:16:50.350615 (Thread-392): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:50.537727 (Thread-393): handling status request
2023-03-31 02:16:50.538175 (Thread-393): 02:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbc70>]}
2023-03-31 02:16:50.538746 (Thread-393): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:50.657971 (Thread-394): handling ps request
2023-03-31 02:16:50.658404 (Thread-394): 02:16:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb490>]}
2023-03-31 02:16:50.659333 (Thread-394): sending response (<Response 10454 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:52.600949 (Thread-395): handling poll request
2023-03-31 02:16:52.601383 (Thread-395): 02:16:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9b50>]}
2023-03-31 02:16:52.601838 (Thread-395): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:52.790270 (Thread-396): handling status request
2023-03-31 02:16:52.790708 (Thread-396): 02:16:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a97f0>]}
2023-03-31 02:16:52.791236 (Thread-396): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:53.230343 (Thread-390): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:53.251825 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 768, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<unknown>", line 12, in template
jinja2.exceptions.TemplateSyntaxError: unexpected ')', expected ']'
  line 12
    {{ dbt_utils.surrogate_key(['study_area', SPLIT(image, '/')[OFFSET(5)]) }} as image_id,

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 166, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    rpc_node = rpc_parser.parse_remote(sql, self.args.name, self.args.language)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/parser/rpc.py", line 47, in parse_remote
    return self.parse_node(contents)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 386, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 362, in render_update
    context = self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 240, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 583, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    raise CompilationError(str(e), node) from e
dbt.exceptions.CompilationError: Compilation Error in rpc request (from remote system.sql)
  unexpected ')', expected ']'
    line 12
      {{ dbt_utils.surrogate_key(['study_area', SPLIT(image, '/')[OFFSET(5)]) }} as image_id,
2023-03-31 02:16:53.480018 (Thread-397): handling ps request
2023-03-31 02:16:53.480489 (Thread-397): 02:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5a9e20>]}
2023-03-31 02:16:53.481473 (Thread-397): sending response (<Response 10449 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:53.488788 (Thread-398): handling ps request
2023-03-31 02:16:53.489145 (Thread-398): 02:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd1fee0>]}
2023-03-31 02:16:53.490010 (Thread-398): sending response (<Response 10449 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:53.682416 (Thread-399): handling status request
2023-03-31 02:16:53.682853 (Thread-399): 02:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd1fee0>]}
2023-03-31 02:16:53.683370 (Thread-399): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:53.803310 (Thread-400): handling poll request
2023-03-31 02:16:53.803756 (Thread-400): 02:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb820>]}
2023-03-31 02:16:53.804270 (Thread-400): sending response (<Response 4848 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:54.798278 (Thread-401): handling poll request
2023-03-31 02:16:54.798720 (Thread-401): 02:16:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb66d760>]}
2023-03-31 02:16:54.799213 (Thread-401): sending response (<Response 4848 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:55.420855 (Thread-402): handling status request
2023-03-31 02:16:55.421315 (Thread-402): 02:16:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb665250>]}
2023-03-31 02:16:55.421840 (Thread-402): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:55.718549 (Thread-403): handling ps request
2023-03-31 02:16:55.719040 (Thread-403): 02:16:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb665310>]}
2023-03-31 02:16:55.720010 (Thread-403): sending response (<Response 10472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:16:55.914339 (Thread-404): handling status request
2023-03-31 02:16:55.914785 (Thread-404): 02:16:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9760>]}
2023-03-31 02:16:55.915305 (Thread-404): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:39.834087 (Thread-405): handling run_sql request
2023-03-31 02:17:39.834543 (Thread-405): 02:17:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b94f0>]}
2023-03-31 02:17:39.842412 (Thread-406): handling ps request
2023-03-31 02:17:39.860526 (Thread-406): 02:17:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8670>]}
2023-03-31 02:17:39.889283 (Thread-406): sending response (<Response 11035 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:40.153838 (Thread-407): handling poll request
2023-03-31 02:17:40.154289 (Thread-407): 02:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8a90>]}
2023-03-31 02:17:40.154810 (Thread-407): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:40.345792 (Thread-408): handling status request
2023-03-31 02:17:40.346244 (Thread-408): 02:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8dc0>]}
2023-03-31 02:17:40.346819 (Thread-408): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:40.473955 (Thread-409): handling ps request
2023-03-31 02:17:40.474422 (Thread-409): 02:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8d90>]}
2023-03-31 02:17:40.475395 (Thread-409): sending response (<Response 11034 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:42.561469 (Thread-410): handling poll request
2023-03-31 02:17:42.561932 (Thread-410): 02:17:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a89a0>]}
2023-03-31 02:17:42.562408 (Thread-410): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:42.897798 (Thread-411): handling status request
2023-03-31 02:17:42.898259 (Thread-411): 02:17:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8910>]}
2023-03-31 02:17:42.898794 (Thread-411): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:42.974417 (Thread-405): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:43.024400 (MainThread): 02:17:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc7854c-8e81-4446-b835-05b4df0aa967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0114708700>]}
2023-03-31 02:17:43.025040 (MainThread): 02:17:43  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:17:43.026439 (Thread-1): 02:17:43  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:17:43.026681 (Thread-1): 02:17:43  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:17:43.031748 (Thread-1): 02:17:43  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:17:43.026729 => 2023-03-31 02:17:43.031579
2023-03-31 02:17:43.031899 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system.sql)
  'SPLIT' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 545, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 12, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 391, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 275, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'SPLIT' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 304, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 57, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 524, in compile_node
    node = self._compile_code(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 370, in _compile_code
    node.compiled_code = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 590, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 545, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 518, in catch_jinja
    raise UndefinedMacroError(str(e), node) from e
dbt.exceptions.UndefinedMacroError: Compilation Error in rpc request (from remote system.sql)
  'SPLIT' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2023-03-31 02:17:43.034374 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'UndefinedMacroError', 'message': 'Compilation Error in rpc request (from remote system.sql)\n  \'SPLIT\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', SPLIT(image, \'/\')[OFFSET(5)]]) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'UndefinedMacroError', 'message': 'Compilation Error in rpc request (from remote system.sql)\n  \'SPLIT\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18)) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', SPLIT(image, \'/\')[OFFSET(5)]]) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': None, 'tags': None}, None)
2023-03-31 02:17:43.400551 (Thread-412): handling ps request
2023-03-31 02:17:43.401005 (Thread-412): 02:17:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8940>]}
2023-03-31 02:17:43.401966 (Thread-412): sending response (<Response 11052 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:43.408705 (Thread-413): handling ps request
2023-03-31 02:17:43.409038 (Thread-413): 02:17:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8f10>]}
2023-03-31 02:17:43.409884 (Thread-413): sending response (<Response 11052 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:43.613791 (Thread-414): handling status request
2023-03-31 02:17:43.614256 (Thread-414): 02:17:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8850>]}
2023-03-31 02:17:43.614787 (Thread-414): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:43.723343 (Thread-415): handling poll request
2023-03-31 02:17:43.723789 (Thread-415): 02:17:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8af0>]}
2023-03-31 02:17:43.724359 (Thread-415): sending response (<Response 10071 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:44.899830 (Thread-416): handling poll request
2023-03-31 02:17:44.900384 (Thread-416): 02:17:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5b9760>]}
2023-03-31 02:17:44.900944 (Thread-416): sending response (<Response 10071 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:17:45.525852 (Thread-417): handling status request
2023-03-31 02:17:45.526780 (Thread-417): 02:17:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8970>]}
2023-03-31 02:17:45.527328 (Thread-417): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:37.871363 (Thread-418): handling run_sql request
2023-03-31 02:19:37.872846 (Thread-418): 02:19:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8370>]}
2023-03-31 02:19:37.889710 (Thread-419): handling ps request
2023-03-31 02:19:37.896483 (Thread-419): 02:19:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbf10>]}
2023-03-31 02:19:37.899044 (Thread-419): sending response (<Response 11615 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:38.092603 (Thread-420): handling poll request
2023-03-31 02:19:38.093068 (Thread-420): 02:19:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb910>]}
2023-03-31 02:19:38.093592 (Thread-420): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:38.282440 (Thread-421): handling status request
2023-03-31 02:19:38.282874 (Thread-421): 02:19:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a4a30>]}
2023-03-31 02:19:38.283450 (Thread-421): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:38.564937 (Thread-422): handling ps request
2023-03-31 02:19:38.565387 (Thread-422): 02:19:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a4640>]}
2023-03-31 02:19:38.566370 (Thread-422): sending response (<Response 11615 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:40.334165 (Thread-423): handling poll request
2023-03-31 02:19:40.334615 (Thread-423): 02:19:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a46a0>]}
2023-03-31 02:19:40.335079 (Thread-423): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:40.529549 (Thread-424): handling status request
2023-03-31 02:19:40.529994 (Thread-424): 02:19:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a45e0>]}
2023-03-31 02:19:40.530524 (Thread-424): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:40.982332 (Thread-418): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:41.003914 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 768, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<unknown>", line 12, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}', expected ')'
  line 12
    {{ dbt_utils.surrogate_key(['study_area', 'image_name'] }} as image_id,

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 166, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    rpc_node = rpc_parser.parse_remote(sql, self.args.name, self.args.language)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/parser/rpc.py", line 47, in parse_remote
    return self.parse_node(contents)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 386, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 362, in render_update
    context = self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 240, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 583, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    raise CompilationError(str(e), node) from e
dbt.exceptions.CompilationError: Compilation Error in rpc request (from remote system.sql)
  unexpected '}', expected ')'
    line 12
      {{ dbt_utils.surrogate_key(['study_area', 'image_name'] }} as image_id,
2023-03-31 02:19:41.238449 (Thread-425): handling ps request
2023-03-31 02:19:41.238903 (Thread-425): 02:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb130>]}
2023-03-31 02:19:41.239934 (Thread-425): sending response (<Response 11610 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:41.246462 (Thread-426): handling ps request
2023-03-31 02:19:41.246774 (Thread-426): 02:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a4820>]}
2023-03-31 02:19:41.247601 (Thread-426): sending response (<Response 11609 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:41.437924 (Thread-427): handling status request
2023-03-31 02:19:41.438417 (Thread-427): 02:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a87c0>]}
2023-03-31 02:19:41.438957 (Thread-427): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:41.551195 (Thread-428): handling poll request
2023-03-31 02:19:41.551647 (Thread-428): 02:19:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a42e0>]}
2023-03-31 02:19:41.552197 (Thread-428): sending response (<Response 4798 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:42.535707 (Thread-429): handling poll request
2023-03-31 02:19:42.536177 (Thread-429): 02:19:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a4ee0>]}
2023-03-31 02:19:42.536685 (Thread-429): sending response (<Response 4798 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:43.219894 (Thread-430): handling status request
2023-03-31 02:19:43.220373 (Thread-430): 02:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb661190>]}
2023-03-31 02:19:43.220899 (Thread-430): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:43.851785 (Thread-431): handling ps request
2023-03-31 02:19:43.852262 (Thread-431): 02:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb661280>]}
2023-03-31 02:19:43.853307 (Thread-431): sending response (<Response 11633 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:44.047095 (Thread-432): handling status request
2023-03-31 02:19:44.047579 (Thread-432): 02:19:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6a8040>]}
2023-03-31 02:19:44.048126 (Thread-432): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:56.565524 (Thread-433): handling run_sql request
2023-03-31 02:19:56.566008 (Thread-433): 02:19:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb661550>]}
2023-03-31 02:19:56.583062 (Thread-434): handling ps request
2023-03-31 02:19:56.589554 (Thread-434): 02:19:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6944c0>]}
2023-03-31 02:19:56.592934 (Thread-434): sending response (<Response 12196 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:56.893869 (Thread-435): handling poll request
2023-03-31 02:19:56.894315 (Thread-435): 02:19:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb130>]}
2023-03-31 02:19:56.894833 (Thread-435): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:57.085523 (Thread-436): handling status request
2023-03-31 02:19:57.085975 (Thread-436): 02:19:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbf40>]}
2023-03-31 02:19:57.147822 (Thread-436): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:57.216013 (Thread-437): handling ps request
2023-03-31 02:19:57.216461 (Thread-437): 02:19:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb7c0>]}
2023-03-31 02:19:57.217516 (Thread-437): sending response (<Response 12196 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:59.100000 (Thread-438): handling poll request
2023-03-31 02:19:59.100481 (Thread-438): 02:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb661e50>]}
2023-03-31 02:19:59.100968 (Thread-438): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:59.295219 (Thread-439): handling status request
2023-03-31 02:19:59.295676 (Thread-439): 02:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bb640>]}
2023-03-31 02:19:59.296242 (Thread-439): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:59.707943 (Thread-433): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:59.757311 (MainThread): 02:19:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967be215-2a10-4885-8a80-df2e431fa891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce00f4730>]}
2023-03-31 02:19:59.757932 (MainThread): 02:19:59  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:19:59.759321 (Thread-1): 02:19:59  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:19:59.759563 (Thread-1): 02:19:59  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:19:59.765476 (Thread-1): 02:19:59  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:19:59.759611 => 2023-03-31 02:19:59.765305
2023-03-31 02:19:59.765696 (Thread-1): 02:19:59  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:19:59.765865 (Thread-1): 02:19:59  Opening a new connection, currently in state init
2023-03-31 02:19:59.771064 (Thread-1): 02:19:59  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,
    row_number() over(partition by study_area, image_name) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(study_area as 
    string
), '') || '-' || coalesce(cast(image_name as 
    string
), '') as 
    string
))) as image_id,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:19:59.959201 (Thread-440): handling ps request
2023-03-31 02:19:59.959663 (Thread-440): 02:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbbe0>]}
2023-03-31 02:19:59.960778 (Thread-440): sending response (<Response 12190 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:19:59.967226 (Thread-441): handling ps request
2023-03-31 02:19:59.967546 (Thread-441): 02:19:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb5bbc40>]}
2023-03-31 02:19:59.968428 (Thread-441): sending response (<Response 12191 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:00.260542 (Thread-442): handling status request
2023-03-31 02:20:00.261048 (Thread-442): 02:20:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb661130>]}
2023-03-31 02:20:00.261604 (Thread-442): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:00.345348 (Thread-443): handling poll request
2023-03-31 02:20:00.345748 (Thread-443): 02:20:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb694460>]}
2023-03-31 02:20:00.346304 (Thread-443): sending response (<Response 4207 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:00.503305 (Thread-1): 02:20:00  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [6:48]')
2023-03-31 02:20:00.985080 (Thread-1): 02:20:00  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:282da6a4-070d-48f0-ab26-a8b583a6ee5f&page=queryresults
2023-03-31 02:20:00.985363 (Thread-1): 02:20:00  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:19:59.765743 => 2023-03-31 02:20:00.985216
2023-03-31 02:20:00.985484 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [6:48]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [6:48]

Location: US
Job ID: 282da6a4-070d-48f0-ab26-a8b583a6ee5f


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [6:48]
2023-03-31 02:20:00.987628 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [6:48]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, \'/\')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), '') || '-' || coalesce(cast(image_name as \n    string\n), '') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [6:48]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, \'/\')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, image_name) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, image_name) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), '') || '-' || coalesce(cast(image_name as \n    string\n), '') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:20:01.283773 (Thread-444): handling poll request
2023-03-31 02:20:01.284242 (Thread-444): 02:20:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb694250>]}
2023-03-31 02:20:01.284841 (Thread-444): sending response (<Response 16556 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:01.942553 (Thread-445): handling status request
2023-03-31 02:20:01.942995 (Thread-445): 02:20:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6944c0>]}
2023-03-31 02:20:01.943542 (Thread-445): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:02.048506 (Thread-446): handling poll request
2023-03-31 02:20:02.048994 (Thread-446): 02:20:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb694c10>]}
2023-03-31 02:20:02.049610 (Thread-446): sending response (<Response 16556 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:02.320085 (Thread-447): handling ps request
2023-03-31 02:20:02.320569 (Thread-447): 02:20:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb673190>]}
2023-03-31 02:20:02.321668 (Thread-447): sending response (<Response 12214 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:20:02.571682 (Thread-448): handling status request
2023-03-31 02:20:02.572152 (Thread-448): 02:20:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cb6733d0>]}
2023-03-31 02:20:02.572690 (Thread-448): sending response (<Response 3785 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:21:01.520368 (Thread-449): 02:21:01  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:21:01.742623 (Thread-449): 02:21:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:21:01.743096 (Thread-449): 02:21:01  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:01.750432 (Thread-449): 02:21:01  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:01.773463 (Thread-449): 02:21:01  1602: parser fallback to jinja rendering on staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:01.816399 (Thread-449): 02:21:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:21:01.822465 (Thread-449): 02:21:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8d73d30>]}
2023-03-31 02:21:01.823559 (Thread-450): handling status request
2023-03-31 02:21:01.824253 (Thread-450): 02:21:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8d73ca0>]}
2023-03-31 02:21:01.824718 (Thread-450): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:21:58.617692 (Thread-451): 02:21:58  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:21:58.834499 (Thread-451): 02:21:58  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:21:58.834922 (Thread-451): 02:21:58  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:58.841953 (Thread-451): 02:21:58  1603: static parser failed on staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:58.848378 (Thread-451): 02:21:58  1602: parser fallback to jinja rendering on staging/stg_pusch_ridge_north.sql
2023-03-31 02:21:58.894057 (Thread-451): 02:21:58  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:21:58.899609 (Thread-451): 02:21:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667fc40>]}
2023-03-31 02:21:58.910539 (Thread-452): handling status request
2023-03-31 02:21:58.910860 (Thread-452): 02:21:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6659c70>]}
2023-03-31 02:21:58.911308 (Thread-452): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:00.675401 (Thread-453): handling run_sql request
2023-03-31 02:22:00.675895 (Thread-453): 02:22:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77a41dddf0>]}
2023-03-31 02:22:00.766617 (Thread-454): handling ps request
2023-03-31 02:22:00.767538 (Thread-454): 02:22:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d2d85fa0>]}
2023-03-31 02:22:00.769393 (Thread-454): sending response (<Response 12776 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:00.959045 (Thread-455): handling poll request
2023-03-31 02:22:00.959495 (Thread-455): 02:22:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f66dc040>]}
2023-03-31 02:22:00.960042 (Thread-455): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:01.153401 (Thread-456): handling status request
2023-03-31 02:22:01.153871 (Thread-456): 02:22:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f66dc460>]}
2023-03-31 02:22:01.154443 (Thread-456): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:01.302528 (Thread-457): handling ps request
2023-03-31 02:22:01.302968 (Thread-457): 02:22:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f66dc550>]}
2023-03-31 02:22:01.304022 (Thread-457): sending response (<Response 12777 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:03.167132 (Thread-458): handling poll request
2023-03-31 02:22:03.167586 (Thread-458): 02:22:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667ff70>]}
2023-03-31 02:22:03.168081 (Thread-458): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:03.357933 (Thread-459): handling status request
2023-03-31 02:22:03.358384 (Thread-459): 02:22:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667fbe0>]}
2023-03-31 02:22:03.358891 (Thread-459): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:03.802888 (Thread-453): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:03.851877 (MainThread): 02:22:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66169cae-77f4-4ad6-8f8f-f52cc31cfb17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5922b0460>]}
2023-03-31 02:22:03.852505 (MainThread): 02:22:03  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:22:03.853903 (Thread-1): 02:22:03  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:22:03.854146 (Thread-1): 02:22:03  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:22:03.860093 (Thread-1): 02:22:03  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:22:03.854194 => 2023-03-31 02:22:03.859890
2023-03-31 02:22:03.860317 (Thread-1): 02:22:03  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:22:03.860484 (Thread-1): 02:22:03  Opening a new connection, currently in state init
2023-03-31 02:22:03.865186 (Thread-1): 02:22:03  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn,
    SPLIT(image, '/')[OFFSET(5)] as image_name
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where image_name is not null
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(study_area as 
    string
), '') || '-' || coalesce(cast(image_name as 
    string
), '') as 
    string
))) as image_id,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:22:04.095983 (Thread-460): handling ps request
2023-03-31 02:22:04.096481 (Thread-460): 02:22:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667fd00>]}
2023-03-31 02:22:04.097614 (Thread-460): sending response (<Response 12771 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:04.100946 (Thread-461): handling ps request
2023-03-31 02:22:04.101304 (Thread-461): 02:22:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6659e20>]}
2023-03-31 02:22:04.102178 (Thread-461): sending response (<Response 12772 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:04.391084 (Thread-1): 02:22:04  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: image_name at [9:9]')
2023-03-31 02:22:04.398013 (Thread-462): handling status request
2023-03-31 02:22:04.398421 (Thread-462): 02:22:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df68b100>]}
2023-03-31 02:22:04.398902 (Thread-462): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:04.502226 (Thread-463): handling poll request
2023-03-31 02:22:04.502668 (Thread-463): 02:22:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666e0d0>]}
2023-03-31 02:22:04.503248 (Thread-463): sending response (<Response 4547 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:04.988153 (Thread-1): 02:22:04  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:beba8cd0-0f32-430f-b714-e8ef982eccbc&page=queryresults
2023-03-31 02:22:04.988756 (Thread-1): 02:22:04  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:22:03.860364 => 2023-03-31 02:22:04.988565
2023-03-31 02:22:04.988903 (Thread-1): Got an exception: Database Error
  Unrecognized name: image_name at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: image_name at [9:9]

Location: US
Job ID: beba8cd0-0f32-430f-b714-e8ef982eccbc


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Unrecognized name: image_name at [9:9]
2023-03-31 02:22:04.991212 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [9:9]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn,\n    SPLIT(image, '/')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), '') || '-' || coalesce(cast(image_name as \n    string\n), '') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Unrecognized name: image_name at [9:9]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where image_name is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn,\n    SPLIT(image, '/')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where image_name is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), '') || '-' || coalesce(cast(image_name as \n    string\n), '') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:22:05.370790 (Thread-464): handling poll request
2023-03-31 02:22:05.371235 (Thread-464): 02:22:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666e250>]}
2023-03-31 02:22:05.371841 (Thread-464): sending response (<Response 16504 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:05.999504 (Thread-465): handling status request
2023-03-31 02:22:05.999985 (Thread-465): 02:22:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666eac0>]}
2023-03-31 02:22:06.000492 (Thread-465): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:06.135762 (Thread-466): handling poll request
2023-03-31 02:22:06.136246 (Thread-466): 02:22:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666e7f0>]}
2023-03-31 02:22:06.162274 (Thread-466): sending response (<Response 16504 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:06.565545 (Thread-467): handling ps request
2023-03-31 02:22:06.566012 (Thread-467): 02:22:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666ecd0>]}
2023-03-31 02:22:06.567197 (Thread-467): sending response (<Response 12795 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:06.881053 (Thread-468): handling status request
2023-03-31 02:22:06.881501 (Thread-468): 02:22:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c666ee20>]}
2023-03-31 02:22:06.882009 (Thread-468): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:21.355576 (Thread-469): handling run_sql request
2023-03-31 02:22:21.356126 (Thread-469): 02:22:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df68b910>]}
2023-03-31 02:22:21.373494 (Thread-470): handling ps request
2023-03-31 02:22:21.380706 (Thread-470): 02:22:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8d95400>]}
2023-03-31 02:22:21.385138 (Thread-470): sending response (<Response 13358 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:21.656701 (Thread-471): handling poll request
2023-03-31 02:22:21.657168 (Thread-471): 02:22:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8e03730>]}
2023-03-31 02:22:21.657687 (Thread-471): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:21.956559 (Thread-472): handling status request
2023-03-31 02:22:21.957035 (Thread-472): 02:22:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df87bb20>]}
2023-03-31 02:22:21.957610 (Thread-472): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:22.073573 (Thread-473): handling ps request
2023-03-31 02:22:22.074017 (Thread-473): 02:22:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6662280>]}
2023-03-31 02:22:22.075110 (Thread-473): sending response (<Response 13358 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:24.013430 (Thread-474): handling poll request
2023-03-31 02:22:24.013868 (Thread-474): 02:22:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c66621c0>]}
2023-03-31 02:22:24.014331 (Thread-474): sending response (<Response 471 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:24.204242 (Thread-475): handling status request
2023-03-31 02:22:24.204705 (Thread-475): 02:22:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6662670>]}
2023-03-31 02:22:24.205219 (Thread-475): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:24.455670 (Thread-469): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:24.505054 (MainThread): 02:22:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7399c721-343e-46b5-af93-f5f39eb71d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770bfdb760>]}
2023-03-31 02:22:24.505668 (MainThread): 02:22:24  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:22:24.507075 (Thread-1): 02:22:24  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:22:24.507318 (Thread-1): 02:22:24  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:22:24.513273 (Thread-1): 02:22:24  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:22:24.507367 => 2023-03-31 02:22:24.513102
2023-03-31 02:22:24.513496 (Thread-1): 02:22:24  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:22:24.513664 (Thread-1): 02:22:24  Opening a new connection, currently in state init
2023-03-31 02:22:24.518392 (Thread-1): 02:22:24  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn,
    SPLIT(image, '/')[OFFSET(5)] as image_name
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where "image_name" is not null
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(study_area as 
    string
), '') || '-' || coalesce(cast(image_name as 
    string
), '') as 
    string
))) as image_id,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:22:24.783621 (Thread-476): handling ps request
2023-03-31 02:22:24.784143 (Thread-476): 02:22:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df68b910>]}
2023-03-31 02:22:24.785261 (Thread-476): sending response (<Response 13353 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:24.791631 (Thread-477): handling ps request
2023-03-31 02:22:24.791935 (Thread-477): 02:22:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667fdc0>]}
2023-03-31 02:22:24.792848 (Thread-477): sending response (<Response 13353 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:25.135670 (Thread-478): handling status request
2023-03-31 02:22:25.136153 (Thread-478): 02:22:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667fd00>]}
2023-03-31 02:22:25.136668 (Thread-478): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:25.262222 (Thread-1): 02:22:25  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:22:25.366161 (Thread-479): handling poll request
2023-03-31 02:22:25.366594 (Thread-479): 02:22:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c667ffd0>]}
2023-03-31 02:22:25.367160 (Thread-479): sending response (<Response 4583 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:25.857503 (Thread-1): 02:22:25  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:59625f04-f803-4129-8c24-c140a31e551d&page=queryresults
2023-03-31 02:22:25.857920 (Thread-1): 02:22:25  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:22:24.513542 => 2023-03-31 02:22:25.857760
2023-03-31 02:22:25.858051 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: 59625f04-f803-4129-8c24-c140a31e551d


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:22:25.860196 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': '\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), \'\') || \'-\' || coalesce(cast(image_name as \n    string\n), \'\') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    {{ dbt_utils.surrogate_key([\'study_area\', \'image_name\']) }} as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': '\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(study_area as \n    string\n), \'\') || \'-\' || coalesce(cast(image_name as \n    string\n), \'\') as \n    string\n))) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2023-03-31 02:22:26.208447 (Thread-480): handling poll request
2023-03-31 02:22:26.208927 (Thread-480): 02:22:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8dabf40>]}
2023-03-31 02:22:26.209557 (Thread-480): sending response (<Response 16816 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:26.908413 (Thread-481): handling status request
2023-03-31 02:22:26.908862 (Thread-481): 02:22:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8dab8e0>]}
2023-03-31 02:22:26.909374 (Thread-481): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:27.087241 (Thread-482): handling poll request
2023-03-31 02:22:27.087659 (Thread-482): 02:22:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8dab5e0>]}
2023-03-31 02:22:27.088270 (Thread-482): sending response (<Response 16816 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:27.308263 (Thread-483): handling ps request
2023-03-31 02:22:27.308730 (Thread-483): 02:22:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8d953a0>]}
2023-03-31 02:22:27.309813 (Thread-483): sending response (<Response 13376 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:22:27.738061 (Thread-484): handling status request
2023-03-31 02:22:27.738498 (Thread-484): 02:22:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8d956d0>]}
2023-03-31 02:22:27.738974 (Thread-484): sending response (<Response 2717 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:32.349934 (Thread-485): 02:23:32  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:23:32.578077 (Thread-485): 02:23:32  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:23:32.578814 (Thread-485): 02:23:32  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:23:32.589237 (Thread-485): 02:23:32  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:23:32.640320 (Thread-485): 02:23:32  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:23:32.646860 (Thread-485): 02:23:32  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6547520>]}
2023-03-31 02:23:32.673571 (Thread-486): handling status request
2023-03-31 02:23:32.673932 (Thread-486): 02:23:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6519ac0>]}
2023-03-31 02:23:32.674389 (Thread-486): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:34.113965 (Thread-487): handling run_sql request
2023-03-31 02:23:34.114406 (Thread-487): 02:23:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65198e0>]}
2023-03-31 02:23:34.129925 (Thread-488): handling ps request
2023-03-31 02:23:34.136918 (Thread-488): 02:23:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6160>]}
2023-03-31 02:23:34.139983 (Thread-488): sending response (<Response 13939 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:34.400880 (Thread-489): handling poll request
2023-03-31 02:23:34.401351 (Thread-489): 02:23:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6a60>]}
2023-03-31 02:23:34.401884 (Thread-489): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:34.590776 (Thread-490): handling status request
2023-03-31 02:23:34.591227 (Thread-490): 02:23:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db69d0>]}
2023-03-31 02:23:34.591751 (Thread-490): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:36.625316 (Thread-491): handling poll request
2023-03-31 02:23:36.625758 (Thread-491): 02:23:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6e50>]}
2023-03-31 02:23:36.626229 (Thread-491): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:36.812940 (Thread-492): handling status request
2023-03-31 02:23:36.813393 (Thread-492): 02:23:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6c10>]}
2023-03-31 02:23:36.813865 (Thread-492): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:37.245149 (Thread-487): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:37.279556 (MainThread): 02:23:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8ac9e2e-6e21-4d95-b935-e44e05093f95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71f2584f0>]}
2023-03-31 02:23:37.280188 (MainThread): 02:23:37  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:23:37.281569 (Thread-1): 02:23:37  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:23:37.281809 (Thread-1): 02:23:37  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:23:37.285157 (Thread-1): 02:23:37  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:23:37.281857 => 2023-03-31 02:23:37.284991
2023-03-31 02:23:37.285379 (Thread-1): 02:23:37  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:23:37.285545 (Thread-1): 02:23:37  Opening a new connection, currently in state init
2023-03-31 02:23:37.290289 (Thread-1): 02:23:37  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn,
    SPLIT(image, '/')[OFFSET(5)] as image_name
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where "image_name" is not null
)
select
    -- identifiers
    cast(CONCAT(study_area, image_name) as string) as image_id,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:23:37.586921 (Thread-493): handling ps request
2023-03-31 02:23:37.587388 (Thread-493): 02:23:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6f70>]}
2023-03-31 02:23:37.588606 (Thread-493): sending response (<Response 13934 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:37.595411 (Thread-494): handling ps request
2023-03-31 02:23:37.595760 (Thread-494): 02:23:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6a90>]}
2023-03-31 02:23:37.596770 (Thread-494): sending response (<Response 13934 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:37.893474 (Thread-495): handling status request
2023-03-31 02:23:37.893932 (Thread-495): 02:23:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6ee0>]}
2023-03-31 02:23:37.894415 (Thread-495): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:38.021349 (Thread-496): handling poll request
2023-03-31 02:23:38.020928 (Thread-1): 02:23:38  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:23:38.022064 (Thread-496): 02:23:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546e50>]}
2023-03-31 02:23:38.052785 (Thread-496): sending response (<Response 4485 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:38.862871 (Thread-497): handling poll request
2023-03-31 02:23:38.863321 (Thread-497): 02:23:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546550>]}
2023-03-31 02:23:38.863897 (Thread-497): sending response (<Response 4485 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:39.053502 (Thread-498): handling status request
2023-03-31 02:23:39.053945 (Thread-498): 02:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65461c0>]}
2023-03-31 02:23:39.054421 (Thread-498): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:39.357165 (Thread-499): handling poll request
2023-03-31 02:23:39.357613 (Thread-499): 02:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546130>]}
2023-03-31 02:23:39.358077 (Thread-499): sending response (<Response 467 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:39.469294 (Thread-1): 02:23:39  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:bf8e840c-9d9b-4a6a-bd52-cfe57d47bc19&page=queryresults
2023-03-31 02:23:39.469591 (Thread-1): 02:23:39  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:23:37.285425 => 2023-03-31 02:23:39.469438
2023-03-31 02:23:39.469716 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: bf8e840c-9d9b-4a6a-bd52-cfe57d47bc19


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:23:39.471859 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    cast(CONCAT(study_area, image_name) as string) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': '\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    cast(CONCAT(study_area, image_name) as string) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    cast(CONCAT(study_area, image_name) as string) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': '\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn,\n    SPLIT(image, \'/\')[OFFSET(5)] as image_name\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where "image_name" is not null\n)\nselect\n    -- identifiers\n    cast(CONCAT(study_area, image_name) as string) as image_id,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2023-03-31 02:23:39.892939 (Thread-500): handling ps request
2023-03-31 02:23:39.893411 (Thread-500): 02:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546d00>]}
2023-03-31 02:23:39.894565 (Thread-500): sending response (<Response 13957 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:40.085355 (Thread-501): handling status request
2023-03-31 02:23:40.085800 (Thread-501): 02:23:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546250>]}
2023-03-31 02:23:40.086273 (Thread-501): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:40.546162 (Thread-502): handling poll request
2023-03-31 02:23:40.546608 (Thread-502): 02:23:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546310>]}
2023-03-31 02:23:40.547191 (Thread-502): sending response (<Response 16333 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:41.061638 (Thread-503): handling poll request
2023-03-31 02:23:41.062091 (Thread-503): 02:23:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546d90>]}
2023-03-31 02:23:41.062681 (Thread-503): sending response (<Response 16333 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:23:41.742794 (Thread-504): handling status request
2023-03-31 02:23:41.743256 (Thread-504): 02:23:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654d250>]}
2023-03-31 02:23:41.743742 (Thread-504): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:28.530385 (Thread-505): handling run_sql request
2023-03-31 02:24:28.530845 (Thread-505): 02:24:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654de80>]}
2023-03-31 02:24:28.569175 (Thread-506): handling ps request
2023-03-31 02:24:28.570024 (Thread-506): 02:24:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546b20>]}
2023-03-31 02:24:28.571738 (Thread-506): sending response (<Response 14520 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:28.838453 (Thread-507): handling poll request
2023-03-31 02:24:28.838898 (Thread-507): 02:24:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6fd0>]}
2023-03-31 02:24:28.839405 (Thread-507): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:29.032422 (Thread-508): handling status request
2023-03-31 02:24:29.032861 (Thread-508): 02:24:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6910>]}
2023-03-31 02:24:29.033383 (Thread-508): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:29.166490 (Thread-509): handling ps request
2023-03-31 02:24:29.166941 (Thread-509): 02:24:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db60a0>]}
2023-03-31 02:24:29.168098 (Thread-509): sending response (<Response 14520 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:31.076360 (Thread-510): handling poll request
2023-03-31 02:24:31.076820 (Thread-510): 02:24:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6526070>]}
2023-03-31 02:24:31.077321 (Thread-510): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:31.268800 (Thread-511): handling status request
2023-03-31 02:24:31.269245 (Thread-511): 02:24:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db69d0>]}
2023-03-31 02:24:31.269712 (Thread-511): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:31.652032 (Thread-505): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:31.673567 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 768, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<unknown>", line 12, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}', expected ')'
  line 12
    {{ dbt_utils.surrogate_key(['study_area', 'image_name'] }} as image_id,

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 166, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    rpc_node = rpc_parser.parse_remote(sql, self.args.name, self.args.language)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/parser/rpc.py", line 47, in parse_remote
    return self.parse_node(contents)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 386, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 362, in render_update
    context = self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 240, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 583, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 540, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 516, in catch_jinja
    raise CompilationError(str(e), node) from e
dbt.exceptions.CompilationError: Compilation Error in rpc request (from remote system.sql)
  unexpected '}', expected ')'
    line 12
      {{ dbt_utils.surrogate_key(['study_area', 'image_name'] }} as image_id,
2023-03-31 02:24:31.904021 (Thread-512): handling ps request
2023-03-31 02:24:31.904511 (Thread-512): 02:24:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db69a0>]}
2023-03-31 02:24:31.905776 (Thread-512): sending response (<Response 14515 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:31.911010 (Thread-513): handling ps request
2023-03-31 02:24:31.911330 (Thread-513): 02:24:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6519d60>]}
2023-03-31 02:24:31.912332 (Thread-513): sending response (<Response 14515 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:32.110019 (Thread-514): handling status request
2023-03-31 02:24:32.110455 (Thread-514): 02:24:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6a30>]}
2023-03-31 02:24:32.110930 (Thread-514): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:32.239794 (Thread-515): handling poll request
2023-03-31 02:24:32.240256 (Thread-515): 02:24:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6f40>]}
2023-03-31 02:24:32.240744 (Thread-515): sending response (<Response 4816 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:33.275782 (Thread-516): handling poll request
2023-03-31 02:24:33.276256 (Thread-516): 02:24:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6547340>]}
2023-03-31 02:24:33.276739 (Thread-516): sending response (<Response 4816 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:34.003401 (Thread-517): handling status request
2023-03-31 02:24:34.003861 (Thread-517): 02:24:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654daf0>]}
2023-03-31 02:24:34.004373 (Thread-517): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:34.510853 (Thread-518): handling ps request
2023-03-31 02:24:34.511297 (Thread-518): 02:24:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654d6d0>]}
2023-03-31 02:24:34.512426 (Thread-518): sending response (<Response 14538 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:34.695824 (Thread-519): handling status request
2023-03-31 02:24:34.696298 (Thread-519): 02:24:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654d4f0>]}
2023-03-31 02:24:34.696766 (Thread-519): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:40.000290 (Thread-520): handling run_sql request
2023-03-31 02:24:40.000756 (Thread-520): 02:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654d2b0>]}
2023-03-31 02:24:40.019707 (Thread-521): handling ps request
2023-03-31 02:24:40.024997 (Thread-521): 02:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd040>]}
2023-03-31 02:24:40.028088 (Thread-521): sending response (<Response 15100 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:40.219126 (Thread-522): handling poll request
2023-03-31 02:24:40.219576 (Thread-522): 02:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd2b0>]}
2023-03-31 02:24:40.220155 (Thread-522): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:40.405707 (Thread-523): handling status request
2023-03-31 02:24:40.406221 (Thread-523): 02:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd250>]}
2023-03-31 02:24:40.406775 (Thread-523): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:40.531308 (Thread-524): handling ps request
2023-03-31 02:24:40.531754 (Thread-524): 02:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd370>]}
2023-03-31 02:24:40.532915 (Thread-524): sending response (<Response 15101 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:42.468712 (Thread-525): handling poll request
2023-03-31 02:24:42.469174 (Thread-525): 02:24:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd6a0>]}
2023-03-31 02:24:42.469641 (Thread-525): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:42.653819 (Thread-526): handling status request
2023-03-31 02:24:42.654268 (Thread-526): 02:24:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd640>]}
2023-03-31 02:24:42.684263 (Thread-526): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.099372 (Thread-520): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.132978 (MainThread): 02:24:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed14327-5035-4991-b91c-b079eedbb100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69adfd3d0>]}
2023-03-31 02:24:43.133582 (MainThread): 02:24:43  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:24:43.134942 (Thread-1): 02:24:43  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:24:43.135181 (Thread-1): 02:24:43  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:24:43.138429 (Thread-1): 02:24:43  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:24:43.135229 => 2023-03-31 02:24:43.138262
2023-03-31 02:24:43.138641 (Thread-1): 02:24:43  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:24:43.138804 (Thread-1): 02:24:43  Opening a new connection, currently in state init
2023-03-31 02:24:43.143555 (Thread-1): 02:24:43  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:24:43.376412 (Thread-527): handling ps request
2023-03-31 02:24:43.376878 (Thread-527): 02:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd1c0>]}
2023-03-31 02:24:43.378110 (Thread-527): sending response (<Response 15096 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.384643 (Thread-528): handling ps request
2023-03-31 02:24:43.384972 (Thread-528): 02:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654e50>]}
2023-03-31 02:24:43.385947 (Thread-528): sending response (<Response 15096 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.627767 (Thread-529): handling status request
2023-03-31 02:24:43.628294 (Thread-529): 02:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654b80>]}
2023-03-31 02:24:43.628806 (Thread-529): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.746695 (Thread-530): handling poll request
2023-03-31 02:24:43.747093 (Thread-530): 02:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654ca0>]}
2023-03-31 02:24:43.747636 (Thread-530): sending response (<Response 4062 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:43.831667 (Thread-1): 02:24:43  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:24:44.681142 (Thread-1): 02:24:44  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:f7ba9dd9-3080-49ed-82ec-fc332d8940f7&page=queryresults
2023-03-31 02:24:44.681428 (Thread-1): 02:24:44  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:24:43.138686 => 2023-03-31 02:24:44.681280
2023-03-31 02:24:44.681551 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: f7ba9dd9-3080-49ed-82ec-fc332d8940f7


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:24:44.683700 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, \'/\')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, \'/\')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *, SPLIT(image, '/')[OFFSET(5)] as image_name,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:24:44.758825 (Thread-531): handling poll request
2023-03-31 02:24:44.759270 (Thread-531): 02:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654fd0>]}
2023-03-31 02:24:44.759937 (Thread-531): sending response (<Response 14299 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:44.952570 (Thread-532): handling status request
2023-03-31 02:24:44.953038 (Thread-532): 02:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654ac0>]}
2023-03-31 02:24:44.953538 (Thread-532): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:45.118285 (Thread-533): handling poll request
2023-03-31 02:24:45.118731 (Thread-533): 02:24:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654a60>]}
2023-03-31 02:24:45.119359 (Thread-533): sending response (<Response 15989 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:45.747769 (Thread-534): handling ps request
2023-03-31 02:24:45.748244 (Thread-534): 02:24:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654daf0>]}
2023-03-31 02:24:45.749403 (Thread-534): sending response (<Response 15119 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:45.935581 (Thread-535): handling status request
2023-03-31 02:24:45.936056 (Thread-535): 02:24:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c8db6cd0>]}
2023-03-31 02:24:45.936564 (Thread-535): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:46.960864 (Thread-536): handling poll request
2023-03-31 02:24:46.961315 (Thread-536): 02:24:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65260d0>]}
2023-03-31 02:24:46.961906 (Thread-536): sending response (<Response 15989 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:24:47.633303 (Thread-537): handling status request
2023-03-31 02:24:47.633789 (Thread-537): 02:24:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c654d9d0>]}
2023-03-31 02:24:47.634272 (Thread-537): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:14.810501 (Thread-538): handling run_sql request
2023-03-31 02:25:14.810976 (Thread-538): 02:25:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6546e50>]}
2023-03-31 02:25:14.870606 (Thread-539): handling ps request
2023-03-31 02:25:14.878254 (Thread-539): 02:25:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dad30>]}
2023-03-31 02:25:14.881308 (Thread-539): sending response (<Response 15682 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:15.120978 (Thread-540): handling poll request
2023-03-31 02:25:15.121427 (Thread-540): 02:25:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dafa0>]}
2023-03-31 02:25:15.121937 (Thread-540): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:15.315912 (Thread-541): handling status request
2023-03-31 02:25:15.316386 (Thread-541): 02:25:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dae20>]}
2023-03-31 02:25:15.316927 (Thread-541): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:15.446712 (Thread-542): handling ps request
2023-03-31 02:25:15.447149 (Thread-542): 02:25:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e84c0>]}
2023-03-31 02:25:15.448322 (Thread-542): sending response (<Response 15682 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:17.345664 (Thread-543): handling poll request
2023-03-31 02:25:17.346110 (Thread-543): 02:25:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e82e0>]}
2023-03-31 02:25:17.346575 (Thread-543): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:17.531856 (Thread-544): handling status request
2023-03-31 02:25:17.532323 (Thread-544): 02:25:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e8280>]}
2023-03-31 02:25:17.532804 (Thread-544): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:17.962124 (Thread-538): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:17.995453 (MainThread): 02:25:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82c8ad25-0424-4a2b-b49d-8c6304d305c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff273b370>]}
2023-03-31 02:25:17.996053 (MainThread): 02:25:17  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:25:17.997439 (Thread-1): 02:25:17  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:25:17.997675 (Thread-1): 02:25:17  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:25:18.000935 (Thread-1): 02:25:18  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:25:17.997722 => 2023-03-31 02:25:18.000752
2023-03-31 02:25:18.001160 (Thread-1): 02:25:18  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:25:18.001324 (Thread-1): 02:25:18  Opening a new connection, currently in state init
2023-03-31 02:25:18.006145 (Thread-1): 02:25:18  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18)) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:25:18.182884 (Thread-545): handling ps request
2023-03-31 02:25:18.183341 (Thread-545): 02:25:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e8400>]}
2023-03-31 02:25:18.184711 (Thread-545): sending response (<Response 15677 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:18.189643 (Thread-546): handling ps request
2023-03-31 02:25:18.189948 (Thread-546): 02:25:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e85e0>]}
2023-03-31 02:25:18.191354 (Thread-546): sending response (<Response 15677 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:18.436623 (Thread-547): handling status request
2023-03-31 02:25:18.437141 (Thread-547): 02:25:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65da280>]}
2023-03-31 02:25:18.437644 (Thread-547): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:18.538860 (Thread-548): handling poll request
2023-03-31 02:25:18.539361 (Thread-548): 02:25:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65465b0>]}
2023-03-31 02:25:18.539943 (Thread-548): sending response (<Response 4095 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:19.484693 (Thread-1): 02:25:19  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:ce417d9a-b6b3-46fc-b719-3c119f3088fa&page=queryresults
2023-03-31 02:25:19.485192 (Thread-1): 02:25:19  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:25:18.001206 => 2023-03-31 02:25:19.485029
2023-03-31 02:25:19.535617 (Thread-549): handling poll request
2023-03-31 02:25:19.536097 (Thread-549): 02:25:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654b20>]}
2023-03-31 02:25:19.536735 (Thread-549): sending response (<Response 4957 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:19.726478 (Thread-550): handling status request
2023-03-31 02:25:19.726998 (Thread-550): 02:25:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd2b0>]}
2023-03-31 02:25:19.727490 (Thread-550): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:19.887231 (Thread-551): handling poll request
2023-03-31 02:25:19.887670 (Thread-551): 02:25:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654c70>]}
2023-03-31 02:25:19.890137 (Thread-551): sending response (<Response 28754 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:20.416195 (Thread-552): handling ps request
2023-03-31 02:25:20.416642 (Thread-552): 02:25:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65ddf70>]}
2023-03-31 02:25:20.417808 (Thread-552): sending response (<Response 15702 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:20.628595 (Thread-553): handling status request
2023-03-31 02:25:20.629061 (Thread-553): 02:25:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd850>]}
2023-03-31 02:25:20.629553 (Thread-553): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:21.730499 (Thread-554): handling poll request
2023-03-31 02:25:21.730946 (Thread-554): 02:25:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd7c0>]}
2023-03-31 02:25:21.733236 (Thread-554): sending response (<Response 32384 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:22.388432 (Thread-555): handling status request
2023-03-31 02:25:22.388934 (Thread-555): 02:25:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e8070>]}
2023-03-31 02:25:22.389425 (Thread-555): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:22.511166 (Thread-556): handling ps request
2023-03-31 02:25:22.511583 (Thread-556): 02:25:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e86d0>]}
2023-03-31 02:25:22.535699 (Thread-556): sending response (<Response 15702 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:46.363115 (Thread-557): handling run_sql request
2023-03-31 02:25:46.363568 (Thread-557): 02:25:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e89a0>]}
2023-03-31 02:25:46.411846 (Thread-558): handling ps request
2023-03-31 02:25:46.412765 (Thread-558): 02:25:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652eee0>]}
2023-03-31 02:25:46.414859 (Thread-558): sending response (<Response 16265 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:46.602067 (Thread-559): handling poll request
2023-03-31 02:25:46.602511 (Thread-559): 02:25:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652ebe0>]}
2023-03-31 02:25:46.603023 (Thread-559): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:46.791177 (Thread-560): handling status request
2023-03-31 02:25:46.791604 (Thread-560): 02:25:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e3a0>]}
2023-03-31 02:25:46.792161 (Thread-560): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:46.907932 (Thread-561): handling ps request
2023-03-31 02:25:46.908397 (Thread-561): 02:25:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e4c0>]}
2023-03-31 02:25:46.910269 (Thread-561): sending response (<Response 16265 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:48.844679 (Thread-562): handling poll request
2023-03-31 02:25:48.845135 (Thread-562): 02:25:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654ee0>]}
2023-03-31 02:25:48.845602 (Thread-562): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:49.035508 (Thread-563): handling status request
2023-03-31 02:25:49.035950 (Thread-563): 02:25:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654e80>]}
2023-03-31 02:25:49.036462 (Thread-563): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:49.428519 (Thread-557): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:49.461763 (MainThread): 02:25:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ace5a0a-c452-42cb-8899-2fef7c3c6d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa3a0654f0>]}
2023-03-31 02:25:49.462352 (MainThread): 02:25:49  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:25:49.463675 (Thread-1): 02:25:49  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:25:49.463911 (Thread-1): 02:25:49  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:25:49.467152 (Thread-1): 02:25:49  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:25:49.463982 => 2023-03-31 02:25:49.466990
2023-03-31 02:25:49.467361 (Thread-1): 02:25:49  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:25:49.467522 (Thread-1): 02:25:49  Opening a new connection, currently in state init
2023-03-31 02:25:49.472284 (Thread-1): 02:25:49  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)] as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:25:49.703642 (Thread-1): 02:25:49  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [6:77]')
2023-03-31 02:25:49.729740 (Thread-564): handling ps request
2023-03-31 02:25:49.730177 (Thread-564): 02:25:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65465b0>]}
2023-03-31 02:25:49.731455 (Thread-564): sending response (<Response 16260 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:49.736955 (Thread-565): handling ps request
2023-03-31 02:25:49.737267 (Thread-565): 02:25:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dadf0>]}
2023-03-31 02:25:49.738298 (Thread-565): sending response (<Response 16260 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:49.968149 (Thread-1): 02:25:49  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:db1987ad-8567-4dc8-ba94-a6c0b347305e&page=queryresults
2023-03-31 02:25:49.968432 (Thread-1): 02:25:49  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:25:49.467406 => 2023-03-31 02:25:49.968288
2023-03-31 02:25:49.968555 (Thread-1): Got an exception: Database Error
  Syntax error: Expected ")" but got keyword AS at [6:77]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got keyword AS at [6:77]

Location: US
Job ID: db1987ad-8567-4dc8-ba94-a6c0b347305e


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Syntax error: Expected ")" but got keyword AS at [6:77]
2023-03-31 02:25:49.970715 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected ")" but got keyword AS at [6:77]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)] as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)] as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected ")" but got keyword AS at [6:77]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)] as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)] as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:25:49.981540 (Thread-566): handling status request
2023-03-31 02:25:49.981927 (Thread-566): 02:25:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652efa0>]}
2023-03-31 02:25:49.982400 (Thread-566): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:50.267474 (Thread-567): handling poll request
2023-03-31 02:25:50.267917 (Thread-567): 02:25:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652ed00>]}
2023-03-31 02:25:50.268604 (Thread-567): sending response (<Response 14325 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:51.080781 (Thread-568): handling poll request
2023-03-31 02:25:51.081244 (Thread-568): 02:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652ed00>]}
2023-03-31 02:25:51.081850 (Thread-568): sending response (<Response 16042 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:51.796470 (Thread-569): handling status request
2023-03-31 02:25:51.796926 (Thread-569): 02:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e520>]}
2023-03-31 02:25:51.797421 (Thread-569): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:51.953977 (Thread-570): handling poll request
2023-03-31 02:25:51.954451 (Thread-570): 02:25:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e7c0>]}
2023-03-31 02:25:51.955060 (Thread-570): sending response (<Response 16042 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:52.001857 (Thread-571): handling ps request
2023-03-31 02:25:52.002170 (Thread-571): 02:25:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e550>]}
2023-03-31 02:25:52.003317 (Thread-571): sending response (<Response 16283 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:25:52.432314 (Thread-572): handling status request
2023-03-31 02:25:52.432772 (Thread-572): 02:25:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e970>]}
2023-03-31 02:25:52.433266 (Thread-572): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:09.338858 (Thread-573): handling run_sql request
2023-03-31 02:26:09.339327 (Thread-573): 02:26:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e2b0>]}
2023-03-31 02:26:09.356032 (Thread-574): handling ps request
2023-03-31 02:26:09.364227 (Thread-574): 02:26:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec6e50>]}
2023-03-31 02:26:09.367669 (Thread-574): sending response (<Response 16846 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:09.597306 (Thread-575): handling poll request
2023-03-31 02:26:09.597739 (Thread-575): 02:26:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec6f70>]}
2023-03-31 02:26:09.598244 (Thread-575): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:09.787450 (Thread-576): handling status request
2023-03-31 02:26:09.787885 (Thread-576): 02:26:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec40d0>]}
2023-03-31 02:26:09.788438 (Thread-576): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:09.919362 (Thread-577): handling ps request
2023-03-31 02:26:09.919761 (Thread-577): 02:26:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4130>]}
2023-03-31 02:26:09.921000 (Thread-577): sending response (<Response 16846 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:11.834116 (Thread-578): handling poll request
2023-03-31 02:26:11.834561 (Thread-578): 02:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4490>]}
2023-03-31 02:26:11.835032 (Thread-578): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:12.027550 (Thread-579): handling status request
2023-03-31 02:26:12.028074 (Thread-579): 02:26:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec6e20>]}
2023-03-31 02:26:12.028581 (Thread-579): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:12.430091 (Thread-573): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:12.463416 (MainThread): 02:26:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bced3ce-18e9-4913-8770-cb33f934657b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf10c0a370>]}
2023-03-31 02:26:12.464024 (MainThread): 02:26:12  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:26:12.465370 (Thread-1): 02:26:12  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:26:12.465615 (Thread-1): 02:26:12  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:26:12.468853 (Thread-1): 02:26:12  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:26:12.465664 => 2023-03-31 02:26:12.468687
2023-03-31 02:26:12.469086 (Thread-1): 02:26:12  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:26:12.469252 (Thread-1): 02:26:12  Opening a new connection, currently in state init
2023-03-31 02:26:12.473860 (Thread-1): 02:26:12  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:26:12.684732 (Thread-580): handling ps request
2023-03-31 02:26:12.685208 (Thread-580): 02:26:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4550>]}
2023-03-31 02:26:12.686558 (Thread-580): sending response (<Response 16841 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:12.693633 (Thread-581): handling ps request
2023-03-31 02:26:12.693951 (Thread-581): 02:26:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4730>]}
2023-03-31 02:26:12.695398 (Thread-581): sending response (<Response 16841 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:13.025966 (Thread-582): handling status request
2023-03-31 02:26:13.026453 (Thread-582): 02:26:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65461c0>]}
2023-03-31 02:26:13.026936 (Thread-582): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:13.067391 (Thread-1): 02:26:13  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:26:13.159266 (Thread-583): handling poll request
2023-03-31 02:26:13.159720 (Thread-583): 02:26:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652ed30>]}
2023-03-31 02:26:13.160362 (Thread-583): sending response (<Response 4462 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:14.065467 (Thread-584): handling poll request
2023-03-31 02:26:14.065920 (Thread-584): 02:26:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c652e550>]}
2023-03-31 02:26:14.066501 (Thread-584): sending response (<Response 4462 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:14.079240 (Thread-1): 02:26:14  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:892b6c5d-76b2-48f7-a5f4-4644a2037ba4&page=queryresults
2023-03-31 02:26:14.079620 (Thread-1): 02:26:14  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:26:12.469133 => 2023-03-31 02:26:14.079434
2023-03-31 02:26:14.079753 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: 892b6c5d-76b2-48f7-a5f4-4644a2037ba4


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:26:14.081947 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:26:14.264888 (Thread-585): handling status request
2023-03-31 02:26:14.265343 (Thread-585): 02:26:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dad30>]}
2023-03-31 02:26:14.265824 (Thread-585): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:14.421779 (Thread-586): handling poll request
2023-03-31 02:26:14.422216 (Thread-586): 02:26:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65da850>]}
2023-03-31 02:26:14.449722 (Thread-586): sending response (<Response 16140 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:15.143153 (Thread-587): handling ps request
2023-03-31 02:26:15.143599 (Thread-587): 02:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654f40>]}
2023-03-31 02:26:15.144858 (Thread-587): sending response (<Response 16864 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:15.335920 (Thread-588): handling status request
2023-03-31 02:26:15.336389 (Thread-588): 02:26:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec46a0>]}
2023-03-31 02:26:15.336867 (Thread-588): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:16.261509 (Thread-589): handling poll request
2023-03-31 02:26:16.261945 (Thread-589): 02:26:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4970>]}
2023-03-31 02:26:16.262544 (Thread-589): sending response (<Response 16140 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:26:16.962989 (Thread-590): handling status request
2023-03-31 02:26:16.963443 (Thread-590): 02:26:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec4310>]}
2023-03-31 02:26:16.963924 (Thread-590): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:27:58.150496 (Thread-591): handling status request
2023-03-31 02:27:58.152062 (Thread-591): 02:27:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1040>]}
2023-03-31 02:27:58.152546 (Thread-591): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:07.888041 (Thread-592): handling run_sql request
2023-03-31 02:28:07.888489 (Thread-592): 02:28:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1130>]}
2023-03-31 02:28:07.906987 (Thread-593): handling ps request
2023-03-31 02:28:07.912302 (Thread-593): 02:28:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb130>]}
2023-03-31 02:28:07.915839 (Thread-593): sending response (<Response 17427 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:08.106070 (Thread-594): handling poll request
2023-03-31 02:28:08.106533 (Thread-594): 02:28:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb3a0>]}
2023-03-31 02:28:08.107056 (Thread-594): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:08.297510 (Thread-595): handling status request
2023-03-31 02:28:08.297947 (Thread-595): 02:28:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb340>]}
2023-03-31 02:28:08.298467 (Thread-595): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:08.460645 (Thread-596): handling ps request
2023-03-31 02:28:08.461111 (Thread-596): 02:28:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb460>]}
2023-03-31 02:28:08.462387 (Thread-596): sending response (<Response 17427 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:10.358829 (Thread-597): handling poll request
2023-03-31 02:28:10.359318 (Thread-597): 02:28:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1fd0>]}
2023-03-31 02:28:10.359793 (Thread-597): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:10.551263 (Thread-598): handling status request
2023-03-31 02:28:10.551700 (Thread-598): 02:28:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb7c0>]}
2023-03-31 02:28:10.552220 (Thread-598): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.014241 (Thread-592): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.048932 (MainThread): 02:28:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f1ec056-b64a-4689-b1bc-14cd307ea5a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88e17e670>]}
2023-03-31 02:28:11.049534 (MainThread): 02:28:11  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:28:11.050886 (Thread-1): 02:28:11  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:28:11.051129 (Thread-1): 02:28:11  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:28:11.054392 (Thread-1): 02:28:11  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:28:11.051178 => 2023-03-31 02:28:11.054225
2023-03-31 02:28:11.054610 (Thread-1): 02:28:11  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:28:11.054776 (Thread-1): 02:28:11  Opening a new connection, currently in state init
2023-03-31 02:28:11.059516 (Thread-1): 02:28:11  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(min as numeric) as ndvi_min,
    cast(max as numeric) as ndvi_max,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:28:11.203714 (Thread-599): handling ps request
2023-03-31 02:28:11.204205 (Thread-599): 02:28:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb8b0>]}
2023-03-31 02:28:11.205576 (Thread-599): sending response (<Response 17422 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.210486 (Thread-600): handling ps request
2023-03-31 02:28:11.210809 (Thread-600): 02:28:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb9a0>]}
2023-03-31 02:28:11.212494 (Thread-600): sending response (<Response 17422 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.495604 (Thread-601): handling status request
2023-03-31 02:28:11.496079 (Thread-601): 02:28:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb760>]}
2023-03-31 02:28:11.496580 (Thread-601): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.640191 (Thread-602): handling poll request
2023-03-31 02:28:11.640639 (Thread-602): 02:28:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebbfa0>]}
2023-03-31 02:28:11.641235 (Thread-602): sending response (<Response 4095 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:11.664662 (Thread-1): 02:28:11  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:28:12.555900 (Thread-603): handling poll request
2023-03-31 02:28:12.556379 (Thread-603): 02:28:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb5b0>]}
2023-03-31 02:28:12.556962 (Thread-603): sending response (<Response 4475 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:12.750381 (Thread-604): handling status request
2023-03-31 02:28:12.750822 (Thread-604): 02:28:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebbca0>]}
2023-03-31 02:28:12.751310 (Thread-604): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:12.936836 (Thread-1): 02:28:12  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:bfc9f032-a7d7-4ec8-beb5-be8a6a91953a&page=queryresults
2023-03-31 02:28:12.937141 (Thread-1): 02:28:12  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:28:11.054656 => 2023-03-31 02:28:12.936989
2023-03-31 02:28:12.937273 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: bfc9f032-a7d7-4ec8-beb5-be8a6a91953a


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:28:12.939434 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(min as numeric) as ndvi_min,\n    cast(max as numeric) as ndvi_max,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:28:13.105559 (Thread-605): handling poll request
2023-03-31 02:28:13.106033 (Thread-605): 02:28:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1fd0>]}
2023-03-31 02:28:13.106624 (Thread-605): sending response (<Response 10842 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:13.526304 (Thread-606): handling ps request
2023-03-31 02:28:13.526748 (Thread-606): 02:28:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1fd0>]}
2023-03-31 02:28:13.528027 (Thread-606): sending response (<Response 17445 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:13.711403 (Thread-607): handling status request
2023-03-31 02:28:13.711828 (Thread-607): 02:28:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1b20>]}
2023-03-31 02:28:13.712334 (Thread-607): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:14.303193 (Thread-608): handling poll request
2023-03-31 02:28:14.303645 (Thread-608): 02:28:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1dc0>]}
2023-03-31 02:28:14.304289 (Thread-608): sending response (<Response 16231 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:14.807183 (Thread-609): handling poll request
2023-03-31 02:28:14.807676 (Thread-609): 02:28:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec1130>]}
2023-03-31 02:28:14.808337 (Thread-609): sending response (<Response 16231 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:15.533412 (Thread-610): handling status request
2023-03-31 02:28:15.533867 (Thread-610): 02:28:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec6b50>]}
2023-03-31 02:28:15.534359 (Thread-610): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:28.604470 (Thread-611): handling run_sql request
2023-03-31 02:28:28.604940 (Thread-611): 02:28:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ec6e50>]}
2023-03-31 02:28:28.622489 (Thread-612): handling ps request
2023-03-31 02:28:28.630091 (Thread-612): 02:28:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb15e0>]}
2023-03-31 02:28:28.633496 (Thread-612): sending response (<Response 18008 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:28.865398 (Thread-613): handling poll request
2023-03-31 02:28:28.865845 (Thread-613): 02:28:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1850>]}
2023-03-31 02:28:28.866366 (Thread-613): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:29.057188 (Thread-614): handling status request
2023-03-31 02:28:29.057696 (Thread-614): 02:28:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb18b0>]}
2023-03-31 02:28:29.058253 (Thread-614): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:29.196290 (Thread-615): handling ps request
2023-03-31 02:28:29.196729 (Thread-615): 02:28:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1160>]}
2023-03-31 02:28:29.197989 (Thread-615): sending response (<Response 18008 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:31.074435 (Thread-616): handling poll request
2023-03-31 02:28:31.074915 (Thread-616): 02:28:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1c70>]}
2023-03-31 02:28:31.101212 (Thread-616): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:31.293648 (Thread-617): handling status request
2023-03-31 02:28:31.294096 (Thread-617): 02:28:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb17c0>]}
2023-03-31 02:28:31.294577 (Thread-617): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:31.733486 (Thread-611): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:31.767580 (MainThread): 02:28:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4600584b-01d4-498b-9161-f76881146f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391b6c6490>]}
2023-03-31 02:28:31.768210 (MainThread): 02:28:31  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:28:31.769580 (Thread-1): 02:28:31  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:28:31.769820 (Thread-1): 02:28:31  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:28:31.773163 (Thread-1): 02:28:31  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:28:31.769868 => 2023-03-31 02:28:31.772987
2023-03-31 02:28:31.773377 (Thread-1): 02:28:31  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:28:31.773541 (Thread-1): 02:28:31  Opening a new connection, currently in state init
2023-03-31 02:28:31.778314 (Thread-1): 02:28:31  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as numeric) as ndvi_mean,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:28:32.093613 (Thread-618): handling ps request
2023-03-31 02:28:32.094059 (Thread-618): 02:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1d00>]}
2023-03-31 02:28:32.095446 (Thread-618): sending response (<Response 18003 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:32.102042 (Thread-619): handling ps request
2023-03-31 02:28:32.102362 (Thread-619): 02:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1d90>]}
2023-03-31 02:28:32.103429 (Thread-619): sending response (<Response 18003 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:32.285890 (Thread-620): handling status request
2023-03-31 02:28:32.286347 (Thread-620): 02:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1fd0>]}
2023-03-31 02:28:32.286834 (Thread-620): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:32.412454 (Thread-621): handling poll request
2023-03-31 02:28:32.412898 (Thread-621): 02:28:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1dc0>]}
2023-03-31 02:28:32.413490 (Thread-621): sending response (<Response 4017 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:32.438691 (Thread-1): 02:28:32  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Illegal conversion of non-finite floating point number to numeric: inf')
2023-03-31 02:28:33.337865 (Thread-622): handling poll request
2023-03-31 02:28:33.338347 (Thread-622): 02:28:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb19d0>]}
2023-03-31 02:28:33.338947 (Thread-622): sending response (<Response 4396 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:33.521605 (Thread-623): handling status request
2023-03-31 02:28:33.522060 (Thread-623): 02:28:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb15b0>]}
2023-03-31 02:28:33.522552 (Thread-623): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:33.823613 (Thread-624): handling poll request
2023-03-31 02:28:33.824089 (Thread-624): 02:28:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1d00>]}
2023-03-31 02:28:33.824588 (Thread-624): sending response (<Response 843 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:33.859372 (Thread-1): 02:28:33  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:752da48e-6931-4a9e-907b-872f60d2bef0&page=queryresults
2023-03-31 02:28:33.859665 (Thread-1): 02:28:33  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:28:31.773423 => 2023-03-31 02:28:33.859516
2023-03-31 02:28:33.859793 (Thread-1): Got an exception: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Illegal conversion of non-finite floating point number to numeric: inf

Location: US
Job ID: 752da48e-6931-4a9e-907b-872f60d2bef0


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Illegal conversion of non-finite floating point number to numeric: inf
2023-03-31 02:28:33.862006 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Illegal conversion of non-finite floating point number to numeric: inf', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as numeric) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:28:34.295650 (Thread-625): handling ps request
2023-03-31 02:28:34.296127 (Thread-625): 02:28:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb3d0>]}
2023-03-31 02:28:34.297402 (Thread-625): sending response (<Response 18026 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:34.485612 (Thread-626): handling status request
2023-03-31 02:28:34.486077 (Thread-626): 02:28:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb4c0>]}
2023-03-31 02:28:34.486568 (Thread-626): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:35.016528 (Thread-627): handling poll request
2023-03-31 02:28:35.016988 (Thread-627): 02:28:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb3a0>]}
2023-03-31 02:28:35.017622 (Thread-627): sending response (<Response 15677 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:35.639058 (Thread-628): handling poll request
2023-03-31 02:28:35.639517 (Thread-628): 02:28:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebbe20>]}
2023-03-31 02:28:35.640160 (Thread-628): sending response (<Response 15677 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:36.362951 (Thread-629): handling status request
2023-03-31 02:28:36.363429 (Thread-629): 02:28:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae490>]}
2023-03-31 02:28:36.363935 (Thread-629): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:51.653680 (Thread-630): handling run_sql request
2023-03-31 02:28:51.654158 (Thread-630): 02:28:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae5e0>]}
2023-03-31 02:28:51.671362 (Thread-631): handling ps request
2023-03-31 02:28:51.678092 (Thread-631): 02:28:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab6d0>]}
2023-03-31 02:28:51.681537 (Thread-631): sending response (<Response 18589 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:51.871576 (Thread-632): handling poll request
2023-03-31 02:28:51.872074 (Thread-632): 02:28:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab940>]}
2023-03-31 02:28:51.872623 (Thread-632): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:52.064923 (Thread-633): handling status request
2023-03-31 02:28:52.065368 (Thread-633): 02:28:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab8e0>]}
2023-03-31 02:28:52.065889 (Thread-633): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:52.187334 (Thread-634): handling ps request
2023-03-31 02:28:52.187802 (Thread-634): 02:28:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eaba00>]}
2023-03-31 02:28:52.189655 (Thread-634): sending response (<Response 18589 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:54.119225 (Thread-635): handling poll request
2023-03-31 02:28:54.119674 (Thread-635): 02:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabca0>]}
2023-03-31 02:28:54.120187 (Thread-635): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:54.314257 (Thread-636): handling status request
2023-03-31 02:28:54.314758 (Thread-636): 02:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabe50>]}
2023-03-31 02:28:54.315250 (Thread-636): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:54.759462 (Thread-630): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:54.792977 (MainThread): 02:28:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ca7973-eb25-40b9-bd80-013d501c22c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327ed0b2b0>]}
2023-03-31 02:28:54.793589 (MainThread): 02:28:54  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:28:54.794932 (Thread-1): 02:28:54  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:28:54.795173 (Thread-1): 02:28:54  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:28:54.798442 (Thread-1): 02:28:54  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:28:54.795220 => 2023-03-31 02:28:54.798280
2023-03-31 02:28:54.798655 (Thread-1): 02:28:54  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:28:54.798817 (Thread-1): 02:28:54  Opening a new connection, currently in state init
2023-03-31 02:28:54.803573 (Thread-1): 02:28:54  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    cast(mean as float) as ndvi_mean,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:28:54.972261 (Thread-637): handling ps request
2023-03-31 02:28:54.972705 (Thread-637): 02:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab280>]}
2023-03-31 02:28:54.974080 (Thread-637): sending response (<Response 18584 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:54.978299 (Thread-638): handling ps request
2023-03-31 02:28:54.978603 (Thread-638): 02:28:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb880>]}
2023-03-31 02:28:54.979636 (Thread-638): sending response (<Response 18584 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:55.217402 (Thread-639): handling status request
2023-03-31 02:28:55.217845 (Thread-639): 02:28:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae280>]}
2023-03-31 02:28:55.218356 (Thread-639): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:55.254649 (Thread-1): 02:28:55  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: float at [17:18]')
2023-03-31 02:28:55.346187 (Thread-640): handling poll request
2023-03-31 02:28:55.346634 (Thread-640): 02:28:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae280>]}
2023-03-31 02:28:55.347222 (Thread-640): sending response (<Response 4357 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:56.358106 (Thread-641): handling poll request
2023-03-31 02:28:56.358556 (Thread-641): 02:28:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb2e0>]}
2023-03-31 02:28:56.359146 (Thread-641): sending response (<Response 4357 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:56.547752 (Thread-642): handling status request
2023-03-31 02:28:56.548254 (Thread-642): 02:28:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabeb0>]}
2023-03-31 02:28:56.548736 (Thread-642): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:56.619649 (Thread-1): 02:28:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:c7013e9f-13ef-40f2-9f9d-4a515c023edc&page=queryresults
2023-03-31 02:28:56.619938 (Thread-1): 02:28:56  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:28:54.798700 => 2023-03-31 02:28:56.619790
2023-03-31 02:28:56.620091 (Thread-1): Got an exception: Database Error
  Type not found: float at [17:18]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 222, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 445, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 647, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1507, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1497, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 911, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Type not found: float at [17:18]

Location: US
Job ID: c7013e9f-13ef-40f2-9f9d-4a515c023edc


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 367, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 316, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 270, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 462, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 453, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 662, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 226, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 214, in handle_error
    raise DbtDatabaseError(error_msg)
dbt.exceptions.DbtDatabaseError: Database Error
  Type not found: float at [17:18]
2023-03-31 02:28:56.622269 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Type not found: float at [17:18]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as float) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as float) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DbtDatabaseError', 'message': 'Database Error in rpc request (from remote system.sql)\n  Type not found: float at [17:18]', 'raw_code': '{{ config(materialized="view")}}\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, \'/\')[OFFSET(5)]) as rn\n  from {{ source(\'staging\',\'ndvi_pusch_ridge_north\') }}\n  where SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, \'/\')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, \'-\', month, \'-\', SUBSTR(SPLIT(image, \'/\')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as float) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "\n\nwith stg_push_ridge_north as\n(\n  select *,\n    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn\n  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`\n  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0\n)\nselect\n    -- identifiers\n    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,\n    cast(study_area as string) as study_area,\n    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,\n    cast(year as integer) as year,\n    cast(month as integer) as month,\n    cast(mean as float) as ndvi_mean,\n    cast(pixel_count as integer) as pixel_count,\nfrom stg_push_ridge_north\nwhere rn = 1\norder by year, month\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2023-03-31 02:28:56.710288 (Thread-643): handling poll request
2023-03-31 02:28:56.710740 (Thread-643): 02:28:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb17c0>]}
2023-03-31 02:28:56.711319 (Thread-643): sending response (<Response 9945 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:57.227142 (Thread-644): handling ps request
2023-03-31 02:28:57.227595 (Thread-644): 02:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb14f0>]}
2023-03-31 02:28:57.228926 (Thread-644): sending response (<Response 18607 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:57.417430 (Thread-645): handling status request
2023-03-31 02:28:57.417868 (Thread-645): 02:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1d00>]}
2023-03-31 02:28:57.418346 (Thread-645): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:57.918642 (Thread-646): handling poll request
2023-03-31 02:28:57.919093 (Thread-646): 02:28:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb16a0>]}
2023-03-31 02:28:57.940279 (Thread-646): sending response (<Response 15397 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:58.715041 (Thread-647): handling poll request
2023-03-31 02:28:58.715504 (Thread-647): 02:28:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1880>]}
2023-03-31 02:28:58.716148 (Thread-647): sending response (<Response 15397 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:28:59.434357 (Thread-648): handling status request
2023-03-31 02:28:59.434815 (Thread-648): 02:28:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1d60>]}
2023-03-31 02:28:59.435310 (Thread-648): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:20.257525 (Thread-649): handling run_sql request
2023-03-31 02:29:20.258002 (Thread-649): 02:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1370>]}
2023-03-31 02:29:20.277458 (Thread-650): handling ps request
2023-03-31 02:29:20.282620 (Thread-650): 02:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e967c0>]}
2023-03-31 02:29:20.286095 (Thread-650): sending response (<Response 19170 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:20.483257 (Thread-651): handling poll request
2023-03-31 02:29:20.483692 (Thread-651): 02:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96a30>]}
2023-03-31 02:29:20.484262 (Thread-651): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:20.676046 (Thread-652): handling status request
2023-03-31 02:29:20.676474 (Thread-652): 02:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96ac0>]}
2023-03-31 02:29:20.676990 (Thread-652): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:20.820332 (Thread-653): handling ps request
2023-03-31 02:29:20.820757 (Thread-653): 02:29:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96af0>]}
2023-03-31 02:29:20.822761 (Thread-653): sending response (<Response 19170 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:22.714513 (Thread-654): handling poll request
2023-03-31 02:29:22.714955 (Thread-654): 02:29:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96e80>]}
2023-03-31 02:29:22.715421 (Thread-654): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:22.907705 (Thread-655): handling status request
2023-03-31 02:29:22.908164 (Thread-655): 02:29:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96f10>]}
2023-03-31 02:29:22.908647 (Thread-655): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:23.396015 (Thread-649): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:23.429617 (MainThread): 02:29:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c58a0d3-536e-44fc-b184-1579d4b8a55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0477ff0490>]}
2023-03-31 02:29:23.430200 (MainThread): 02:29:23  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:29:23.431511 (Thread-1): 02:29:23  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:29:23.431748 (Thread-1): 02:29:23  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:29:23.434985 (Thread-1): 02:29:23  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:29:23.431795 => 2023-03-31 02:29:23.434824
2023-03-31 02:29:23.435195 (Thread-1): 02:29:23  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:29:23.435393 (Thread-1): 02:29:23  Opening a new connection, currently in state init
2023-03-31 02:29:23.440201 (Thread-1): 02:29:23  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,

    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:29:23.840748 (Thread-656): handling ps request
2023-03-31 02:29:23.841214 (Thread-656): 02:29:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1700>]}
2023-03-31 02:29:23.842651 (Thread-656): sending response (<Response 19165 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:23.849192 (Thread-657): handling ps request
2023-03-31 02:29:23.849498 (Thread-657): 02:29:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebbdc0>]}
2023-03-31 02:29:23.850595 (Thread-657): sending response (<Response 19165 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:24.032645 (Thread-658): handling status request
2023-03-31 02:29:24.033091 (Thread-658): 02:29:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1700>]}
2023-03-31 02:29:24.033589 (Thread-658): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:24.169439 (Thread-659): handling poll request
2023-03-31 02:29:24.169890 (Thread-659): 02:29:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1280>]}
2023-03-31 02:29:24.170477 (Thread-659): sending response (<Response 3979 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:24.911120 (Thread-660): handling poll request
2023-03-31 02:29:24.911579 (Thread-660): 02:29:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1820>]}
2023-03-31 02:29:24.912198 (Thread-660): sending response (<Response 3979 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:24.913791 (Thread-1): 02:29:24  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:1557ae8b-bb2a-4fb9-b05d-7f439d321b4c&page=queryresults
2023-03-31 02:29:24.914445 (Thread-1): 02:29:24  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:29:23.435242 => 2023-03-31 02:29:24.914267
2023-03-31 02:29:25.102036 (Thread-661): handling status request
2023-03-31 02:29:25.102503 (Thread-661): 02:29:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabc70>]}
2023-03-31 02:29:25.102996 (Thread-661): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:25.464773 (Thread-662): handling poll request
2023-03-31 02:29:25.465231 (Thread-662): 02:29:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab970>]}
2023-03-31 02:29:25.467621 (Thread-662): sending response (<Response 36299 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:26.080696 (Thread-663): handling ps request
2023-03-31 02:29:26.081156 (Thread-663): 02:29:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab0a0>]}
2023-03-31 02:29:26.082423 (Thread-663): sending response (<Response 19189 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:26.272818 (Thread-664): handling status request
2023-03-31 02:29:26.273264 (Thread-664): 02:29:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab490>]}
2023-03-31 02:29:26.273745 (Thread-664): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:27.101599 (Thread-665): handling poll request
2023-03-31 02:29:27.102048 (Thread-665): 02:29:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eaba00>]}
2023-03-31 02:29:27.104308 (Thread-665): sending response (<Response 39813 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:27.839722 (Thread-666): handling status request
2023-03-31 02:29:27.840190 (Thread-666): 02:29:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab4c0>]}
2023-03-31 02:29:27.840665 (Thread-666): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:27.988652 (Thread-667): handling ps request
2023-03-31 02:29:27.989121 (Thread-667): 02:29:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1d30>]}
2023-03-31 02:29:27.990397 (Thread-667): sending response (<Response 19189 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:29:43.883597 (Thread-668): handling status request
2023-03-31 02:29:43.884081 (Thread-668): 02:29:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1ac0>]}
2023-03-31 02:29:43.884570 (Thread-668): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:23.236519 (Thread-669): handling status request
2023-03-31 02:31:23.238105 (Thread-669): 02:31:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1a60>]}
2023-03-31 02:31:23.238581 (Thread-669): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:32.364762 (Thread-670): handling run_sql request
2023-03-31 02:31:32.365238 (Thread-670): 02:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1730>]}
2023-03-31 02:31:32.386254 (Thread-671): handling ps request
2023-03-31 02:31:32.387849 (Thread-671): 02:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96ac0>]}
2023-03-31 02:31:32.390548 (Thread-671): sending response (<Response 19752 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:32.673619 (Thread-672): handling poll request
2023-03-31 02:31:32.674091 (Thread-672): 02:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1f70>]}
2023-03-31 02:31:32.674640 (Thread-672): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:32.869160 (Thread-673): handling status request
2023-03-31 02:31:32.869609 (Thread-673): 02:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb17f0>]}
2023-03-31 02:31:32.870133 (Thread-673): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:32.996042 (Thread-674): handling ps request
2023-03-31 02:31:32.996481 (Thread-674): 02:31:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab5e0>]}
2023-03-31 02:31:32.997846 (Thread-674): sending response (<Response 19752 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:34.913736 (Thread-675): handling poll request
2023-03-31 02:31:34.914198 (Thread-675): 02:31:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ebb8b0>]}
2023-03-31 02:31:34.914671 (Thread-675): sending response (<Response 472 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:35.107520 (Thread-676): handling status request
2023-03-31 02:31:35.108073 (Thread-676): 02:31:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96fd0>]}
2023-03-31 02:31:35.133020 (Thread-676): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:35.558660 (Thread-670): sending response (<Response 133 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:35.594406 (MainThread): 02:31:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad4e5cba-772a-4107-965c-134ed566e1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40fa6ad250>]}
2023-03-31 02:31:35.595038 (MainThread): 02:31:35  Found 1 model, 0 tests, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
2023-03-31 02:31:35.596467 (Thread-1): 02:31:35  Acquiring new bigquery connection 'rpc.dbt_eo_climate.request'
2023-03-31 02:31:35.596704 (Thread-1): 02:31:35  Began compiling node rpc.dbt_eo_climate.request
2023-03-31 02:31:35.600012 (Thread-1): 02:31:35  Timing info for rpc.dbt_eo_climate.request (compile): 2023-03-31 02:31:35.596751 => 2023-03-31 02:31:35.599819
2023-03-31 02:31:35.600226 (Thread-1): 02:31:35  Began executing node rpc.dbt_eo_climate.request
2023-03-31 02:31:35.600390 (Thread-1): 02:31:35  Opening a new connection, currently in state init
2023-03-31 02:31:35.605142 (Thread-1): 02:31:35  On rpc.dbt_eo_climate.request: 

with stg_push_ridge_north as
(
  select *,
    row_number() over(partition by study_area, SPLIT(image, '/')[OFFSET(5)]) as rn
  from `mattsat`.`landsat_data`.`ndvi_pusch_ridge_north`
  where SUBSTR(SPLIT(image, '/')[OFFSET(5)], 18) is not null and mean > 0
)
select
    -- identifiers
    cast(SPLIT(image, '/')[OFFSET(5)] as string) as image_name,
    cast(study_area as string) as study_area,
    cast(CONCAT(year, '-', month, '-', SUBSTR(SPLIT(image, '/')[OFFSET(5)], 24, 2)) as date) as image_dt,
    cast(year as integer) as year,
    cast(month as integer) as month,
    mean as ndvi_mean,
    cast(pixel_count as integer) as pixel_count,
from stg_push_ridge_north
where rn = 1
order by year, month
limit 500
/* limit added automatically by dbt cloud */
2023-03-31 02:31:35.932790 (Thread-677): handling ps request
2023-03-31 02:31:35.933242 (Thread-677): 02:31:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab790>]}
2023-03-31 02:31:35.934640 (Thread-677): sending response (<Response 19747 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:35.941482 (Thread-678): handling ps request
2023-03-31 02:31:35.941798 (Thread-678): 02:31:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae9a0>]}
2023-03-31 02:31:35.942927 (Thread-678): sending response (<Response 19747 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:36.179819 (Thread-679): handling status request
2023-03-31 02:31:36.180312 (Thread-679): 02:31:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c6654580>]}
2023-03-31 02:31:36.180862 (Thread-679): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:36.279995 (Thread-680): handling poll request
2023-03-31 02:31:36.280437 (Thread-680): 02:31:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65e8400>]}
2023-03-31 02:31:36.281015 (Thread-680): sending response (<Response 4001 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:36.988028 (Thread-1): 02:31:36  BigQuery adapter: https://console.cloud.google.com/bigquery?project=mattsat&j=bq:US:72b58641-ab38-4719-be00-d19d9066ba57&page=queryresults
2023-03-31 02:31:36.988699 (Thread-1): 02:31:36  Timing info for rpc.dbt_eo_climate.request (execute): 2023-03-31 02:31:35.600273 => 2023-03-31 02:31:36.988512
2023-03-31 02:31:37.113265 (Thread-681): handling poll request
2023-03-31 02:31:37.113825 (Thread-681): 02:31:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabc10>]}
2023-03-31 02:31:37.114507 (Thread-681): sending response (<Response 4863 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:37.303433 (Thread-682): handling status request
2023-03-31 02:31:37.303888 (Thread-682): 02:31:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65ddbb0>]}
2023-03-31 02:31:37.304421 (Thread-682): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:37.508532 (Thread-683): handling poll request
2023-03-31 02:31:37.509040 (Thread-683): 02:31:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab130>]}
2023-03-31 02:31:37.511911 (Thread-683): sending response (<Response 42379 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:38.172737 (Thread-684): handling ps request
2023-03-31 02:31:38.173212 (Thread-684): 02:31:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c65dd280>]}
2023-03-31 02:31:38.174843 (Thread-684): sending response (<Response 19772 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:38.365432 (Thread-685): handling status request
2023-03-31 02:31:38.365898 (Thread-685): 02:31:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab730>]}
2023-03-31 02:31:38.366392 (Thread-685): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:38.741545 (Thread-686): handling poll request
2023-03-31 02:31:38.742008 (Thread-686): 02:31:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eaba60>]}
2023-03-31 02:31:38.744780 (Thread-686): sending response (<Response 42379 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:39.309365 (Thread-687): handling poll request
2023-03-31 02:31:39.309838 (Thread-687): 02:31:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab7f0>]}
2023-03-31 02:31:39.312661 (Thread-687): sending response (<Response 45915 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:40.508286 (Thread-688): handling poll request
2023-03-31 02:31:40.508792 (Thread-688): 02:31:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabc10>]}
2023-03-31 02:31:40.511634 (Thread-688): sending response (<Response 45915 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:40.954032 (Thread-689): handling poll request
2023-03-31 02:31:40.954476 (Thread-689): 02:31:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eabb80>]}
2023-03-31 02:31:40.957231 (Thread-689): sending response (<Response 42379 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:42.704341 (Thread-690): handling poll request
2023-03-31 02:31:42.704798 (Thread-690): 02:31:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eb1a00>]}
2023-03-31 02:31:42.707644 (Thread-690): sending response (<Response 45915 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:45.157719 (Thread-691): handling poll request
2023-03-31 02:31:45.158184 (Thread-691): 02:31:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96dc0>]}
2023-03-31 02:31:45.160922 (Thread-691): sending response (<Response 42379 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:46.908959 (Thread-692): handling poll request
2023-03-31 02:31:46.909411 (Thread-692): 02:31:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e96370>]}
2023-03-31 02:31:46.912382 (Thread-692): sending response (<Response 45915 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:31:47.109021 (Thread-693): handling status request
2023-03-31 02:31:47.109475 (Thread-693): 02:31:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e967c0>]}
2023-03-31 02:31:47.109950 (Thread-693): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:55.642681 (Thread-694): handling kill request
2023-03-31 02:32:55.644260 (Thread-694): 02:32:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae0a0>]}
2023-03-31 02:32:55.644763 (Thread-694): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:56.828407 (Thread-695): handling kill request
2023-03-31 02:32:56.828878 (Thread-695): 02:32:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae460>]}
2023-03-31 02:32:56.829344 (Thread-695): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:57.434612 (Thread-696): handling kill request
2023-03-31 02:32:57.435107 (Thread-696): 02:32:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eab790>]}
2023-03-31 02:32:57.435549 (Thread-696): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:57.795846 (Thread-697): handling kill request
2023-03-31 02:32:57.796318 (Thread-697): 02:32:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae9d0>]}
2023-03-31 02:32:57.796761 (Thread-697): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:58.137558 (Thread-698): handling kill request
2023-03-31 02:32:58.138027 (Thread-698): 02:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3eae790>]}
2023-03-31 02:32:58.138475 (Thread-698): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:32:58.516292 (Thread-699): handling kill request
2023-03-31 02:32:58.516737 (Thread-699): 02:32:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3e7a8e0>]}
2023-03-31 02:32:58.517182 (Thread-699): sending response (<Response 109 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:33:01.235723 (Thread-700): 02:33:01  checksum: 9f5971860ea7956c5d0d162f1c96671df61b5ad9db5c4152918680483cec5347, vars: {}, profile: user, target: None, version: 1.4.5
2023-03-31 02:33:01.462755 (Thread-700): 02:33:01  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2023-03-31 02:33:01.463242 (Thread-700): 02:33:01  Partial parsing: updated file: dbt_eo_climate://dbt_eo_climate/models/staging/stg_pusch_ridge_north.sql
2023-03-31 02:33:01.471293 (Thread-700): 02:33:01  1699: static parser successfully parsed staging/stg_pusch_ridge_north.sql
2023-03-31 02:33:01.518178 (Thread-701): handling status request
2023-03-31 02:33:01.519017 (Thread-700): 02:33:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_eo_climate.example
2023-03-31 02:33:01.519457 (Thread-701): 02:33:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c162fc10>]}
2023-03-31 02:33:01.525280 (Thread-701): sending response (<Response 180 bytes [200 OK]>) to 10.0.216.134
2023-03-31 02:33:01.525928 (Thread-700): 02:33:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3d1b100>]}
2023-03-31 02:33:02.767557 (Thread-702): handling status request
2023-03-31 02:33:02.768032 (Thread-702): 02:33:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0ba87aa1-2afb-4b07-91b0-5697e18ab068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77c3ea1ac0>]}
2023-03-31 02:33:02.768524 (Thread-702): sending response (<Response 2408 bytes [200 OK]>) to 10.0.216.134
